<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌈 虹靈御所｜八字人生兵法系統 - 資料驅動版</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            position: relative;
            overflow-x: hidden;
        }

        /* 星空背景 */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .description {
            font-size: 1rem;
            opacity: 0.8;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tab {
            padding: 12px 24px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .tab.active {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .content {
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .input-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-weight: bold;
            color: #fff;
        }

        .input-group input, .input-group select {
            padding: 12px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 16px;
            backdrop-filter: blur(10px);
        }

        .input-group input::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .results {
            margin-top: 30px;
        }

        .character-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .character-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .character-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4ecdc4;
        }

        .character-role {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .character-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .detail-section {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
        }

        .detail-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #4ecdc4;
        }

        .attributes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .attribute-item {
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
        }

        .attribute-name {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .attribute-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4ecdc4;
        }

        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .skill-tag {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .story-section {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            border-left: 4px solid #4ecdc4;
        }

        .story-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #4ecdc4;
        }

        .story-content {
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .team-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .stat-name {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4ecdc4;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }
            
            .input-section {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .buttons {
                flex-direction: column;
                align-items: center;
            }

            .character-header {
                flex-direction: column;
                gap: 10px;
            }

            .character-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    
    <div class="container">
        <div class="header">
            <div class="logo">🌈</div>
            <h1 class="title">虹靈御所</h1>
            <p class="subtitle">八字人生兵法系統 - 資料驅動版</p>
            <p class="description">基於完整資料庫的智能命理分析系統</p>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="input">
                👤 輸入
            </div>
            <div class="tab" data-tab="team">
                🛡️ 軍團
            </div>
            <div class="tab" data-tab="strategy">
                📋 戰略
            </div>
            <div class="tab" data-tab="analysis">
                📊 分析
            </div>
        </div>

        <div class="content">
            <!-- 輸入頁面 -->
            <div id="input-content" class="tab-content">
                <h2>🎯 命運資料輸入</h2>
                <p>輸入準確的出生時間，開啟你的命運軍團之旅</p>
                
                <div class="input-section">
                    <div class="input-group">
                        <label>姓名</label>
                        <input type="text" id="name" placeholder="請輸入姓名">
                    </div>
                    <div class="input-group">
                        <label>出生年份</label>
                        <input type="number" id="year" placeholder="例如：1985">
                    </div>
                    <div class="input-group">
                        <label>出生月份</label>
                        <input type="number" id="month" placeholder="1-12" min="1" max="12">
                    </div>
                    <div class="input-group">
                        <label>出生日期</label>
                        <input type="number" id="day" placeholder="1-31" min="1" max="31">
                    </div>
                    <div class="input-group">
                        <label>出生時辰</label>
                        <input type="number" id="hour" placeholder="0-23" min="0" max="23">
                    </div>
                    <div class="input-group">
                        <label>出生分鐘</label>
                        <input type="number" id="minute" placeholder="0-59" min="0" max="59">
                    </div>
                </div>

                <div class="input-group">
                    <label>子時計算方式</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="late-son" name="son-time" value="late" checked>
                            <label for="late-son">晚子時（23:00後算隔天）</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="early-son" name="son-time" value="early">
                            <label for="early-son">早子時（00:00不換日）</label>
                        </div>
                    </div>
                </div>

                <div class="buttons">
                    <button class="btn btn-secondary" onclick="loadExample()">載入範例</button>
                    <button class="btn btn-primary" onclick="calculateBazi()">開始命運分析</button>
                </div>
            </div>

            <!-- 軍團頁面 -->
            <div id="team-content" class="tab-content hidden">
                <h2>🛡️ 四時軍團</h2>
                <p>你的專屬命運軍團配置</p>
                
                <div id="team-display">
                    <!-- 軍團顯示區域 -->
                </div>
            </div>

            <!-- 戰略頁面 -->
            <div id="strategy-content" class="tab-content hidden">
                <h2>📋 人生戰略</h2>
                <p>基於八字分析的人生發展建議</p>
                
                <div id="strategy-display">
                    <!-- 戰略顯示區域 -->
                </div>
            </div>

            <!-- 分析頁面 -->
            <div id="analysis-content" class="tab-content hidden">
                <h2>📊 深度分析</h2>
                <p>詳細的命理分析報告</p>
                
                <div id="analysis-display">
                    <!-- 分析顯示區域 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // 完整的資料庫
        const DATABASE = {
            // 默默超的完整命理檔案
            sampleData: {
                "basic_info": {
                    "姓名": "默默超（隆乾造）",
                    "性別": "男",
                    "農曆": "一九八五年八月廿二戌時",
                    "生肖": "牛",
                    "陽曆": "1985-10-06 19:30:00",
                    "真太陽時": "1985-10-06 19:30:00",
                    "人元司令分野": "辛金用事",
                    "出生節氣": "出生於白露後28天18小時，寒露前1天20小時",
                    "白露": "1985年09月08日 00:53:00",
                    "寒露": "1985年10月08日 16:24:32",
                    "星座": "天秤座（Libra）",
                    "二十八星宿": "鬼宿南方朱雀",
                    "胎元": "丙子（澗下水）",
                    "空亡年日": "戌亥（申酉）",
                    "命宮": "丙戌（屋上土）",
                    "胎息": "癸亥（大海水）",
                    "身宮": "甲申（泉中水）",
                    "命卦": "乾卦（西四命）"
                },
                "bazi_details": {
                    "年柱": {
                        "天干": "乙",
                        "地支": "丑",
                        "五行": "木土",
                        "納音": "海中金",
                        "十神": "劫財",
                        "藏干": ["己土", "癸水", "辛金"],
                        "藏干十神": ["正財", "傷官", "傷官"],
                        "星運": "養",
                        "自坐": "養",
                        "空亡": "戌亥",
                        "神煞": ["天乙貴人", "德秀貴人", "福星貴人", "月德合", "國印"]
                    },
                    "月柱": {
                        "天干": "乙",
                        "地支": "酉",
                        "五行": "木金",
                        "納音": "泉中水",
                        "十神": "劫財",
                        "藏干": ["辛金"],
                        "藏干十神": ["傷官"],
                        "星運": "死",
                        "自坐": "絕",
                        "空亡": "午未",
                        "神煞": ["德秀貴人", "月德合", "將星", "空亡"]
                    },
                    "日柱": {
                        "天干": "戊",
                        "地支": "寅",
                        "五行": "土木",
                        "納音": "城牆土",
                        "十神": "元男（日主）",
                        "藏干": ["甲木", "丙火", "戊土"],
                        "藏干十神": ["七殺", "偏印", "比肩"],
                        "星運": "長生",
                        "自坐": "長生",
                        "空亡": "申酉",
                        "神煞": ["天德貴人", "豐子喜", "紅鸞", "天后", "勾陳"]
                    },
                    "時柱": {
                        "天干": "壬",
                        "地支": "戌",
                        "五行": "水土",
                        "納音": "大海水",
                        "十神": "偏財",
                        "藏干": ["戊土", "丁火", "辛金"],
                        "藏干十神": ["比肩", "正印", "傷官"],
                        "星運": "冠",
                        "自坐": "冠帶",
                        "空亡": "子丑",
                        "神煞": ["天極貴人", "豐宮", "血刃", "空亡", "披麻"]
                    }
                },
                "character_team": {
                    "user_name": "默默超",
                    "birth_info": "1985年10月6日戌時（天秤座）",
                    "main_characters": [
                        {
                            "pillar": "年柱",
                            "role": "主將",
                            "description": "領導統御",
                            "element": "乙丑",
                            "attributes": {
                                "魅力": 3,
                                "統御": 3,
                                "人脈": 2
                            },
                            "skills": ["社交達人", "貴人相助", "團隊凝聚"],
                            "background": "年柱乙丑海中金，天乙貴人護持，具備天生的領袖氣質和貴人運。擅長整合資源，帶領團隊。"
                        },
                        {
                            "pillar": "月柱",
                            "role": "軍師",
                            "description": "智謀策略",
                            "element": "乙酉",
                            "attributes": {
                                "智力": 3,
                                "策略": 3,
                                "分析": 2
                            },
                            "skills": ["策略制定", "風險分析", "決策支援"],
                            "background": "月柱乙酉泉中水，將星坐命，具備敏銳的洞察力和戰略思維。善於分析局勢，制定長遠計劃。"
                        },
                        {
                            "pillar": "日柱",
                            "role": "副將",
                            "description": "執行力量",
                            "element": "戊寅",
                            "attributes": {
                                "力量": 4,
                                "執行": 4,
                                "堅韌": 3
                            },
                            "skills": ["強力執行", "不屈意志", "突破障礙"],
                            "background": "日柱戊寅城牆土，日坐長生，天德貴人加持。具備堅實的執行能力和持久的耐力。"
                        },
                        {
                            "pillar": "時柱",
                            "role": "士兵",
                            "description": "基礎支援",
                            "element": "壬戌",
                            "attributes": {
                                "體質": 3,
                                "支援": 3,
                                "財運": 3
                            },
                            "skills": ["資源管理", "後勤支援", "財富積累"],
                            "background": "時柱壬戌大海水，偏財透幹，天極貴人守護。擅長資源調配和財富管理。"
                        }
                    ],
                    "team_stats": {
                        "總戰力": 85,
                        "創意指數": 92,
                        "財運指數": 78,
                        "人脈指數": 88,
                        "執行力": 82,
                        "領導力": 80
                    }
                },
                "life_strategy": {
                    "事業發展": {
                        "優勢領域": ["創意產業", "教育培訓", "諮詢服務", "文化傳媒"],
                        "發展建議": [
                            "發揮傷官創意優勢，在創新領域大展身手",
                            "善用貴人運，建立廣泛的人脈關係",
                            "穩步經營，避免過度冒險投資",
                            "可考慮合夥事業，發揮團隊協作優勢"
                        ],
                        "注意事項": [
                            "日主偏弱，需要團隊支持，避免單打獨鬥",
                            "財星較重，理財要謹慎，避免過度消費",
                            "傷官旺盛，表達時要注意分寸"
                        ]
                    },
                    "人際關係": {
                        "人緣特點": "天生具備貴人運，容易得到他人幫助",
                        "社交建議": [
                            "多參加文化藝術活動，擴展人脈圈",
                            "善用傷官的表達能力，成為意見領袖",
                            "建立長期穩定的合作關係"
                        ],
                        "感情婚姻": [
                            "偏財透幹，感情機會多但要專一",
                            "適合找火土五行的伴侶，互相扶持",
                            "戀愛中要控制傷官的挑剔性格"
                        ]
                    },
                    "健康養生": {
                        "體質特點": "戊土日主坐寅木，脾胃功能需要注意",
                        "養生建議": [
                            "多接觸火性能量，如陽光、溫泉",
                            "飲食以溫熱為主，避免過寒食物",
                            "適合南方或溫暖地區居住工作",
                            "保持規律作息，避免過度勞累"
                        ]
                    },
                    "財富管理": {
                        "財運特點": "偏財正財並現，財運不錯但要謹慎管理",
                        "理財建議": [
                            "分散投資，不要把雞蛋放在同一個籃子",
                            "避免衝動性消費，制定預算計劃",
                            "可考慮文化創意相關投資",
                            "建立應急基金，應對突發狀況"
                        ]
                    }
                }
            },

            // 軍團轉化對照表
            legionMapping: {
                "年柱": {
                    "role": "主將",
                    "legion": "外交軍團",
                    "function": "統籌大局、建立聯盟、獲取外援",
                    "strategy": "利用貴人運建立廣泛聯盟，在關鍵時刻獲得重要支持"
                },
                "月柱": {
                    "role": "軍師", 
                    "legion": "情報軍團",
                    "function": "情報收集、風險評估、戰術制定",
                    "strategy": "深度分析局勢，制定周密計劃，預判對手動向"
                },
                "日柱": {
                    "role": "副將",
                    "legion": "重裝軍團", 
                    "function": "正面突破、堅守陣地、執行計劃",
                    "strategy": "承擔主要執行任務，在關鍵戰役中發揮決定性作用"
                },
                "時柱": {
                    "role": "士兵統領",
                    "legion": "後勤軍團",
                    "function": "資源調配、財務管理、機會捕獲", 
                    "strategy": "確保充足補給，在適當時機投入資源獲取最大收益"
                }
            }
        };

        // 全局變量
        let currentResult = null;

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            createStars();
            initTabs();
        });

        // 創建星空背景
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const starCount = 100;

            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // 初始化標籤
        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });
        }

        // 切換標籤
        function switchTab(tabName) {
            // 更新標籤狀態
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // 更新內容顯示
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabName}-content`).classList.remove('hidden');
        }

        // 載入範例
        function loadExample() {
            document.getElementById('name').value = '默默超';
            document.getElementById('year').value = '1985';
            document.getElementById('month').value = '10';
            document.getElementById('day').value = '6';
            document.getElementById('hour').value = '19';
            document.getElementById('minute').value = '30';
            document.getElementById('late-son').checked = true;
        }

        // 計算八字
        function calculateBazi() {
            const name = document.getElementById('name').value;
            const year = parseInt(document.getElementById('year').value);
            const month = parseInt(document.getElementById('month').value);
            const day = parseInt(document.getElementById('day').value);
            const hour = parseInt(document.getElementById('hour').value);
            const minute = parseInt(document.getElementById('minute').value) || 0;

            if (!name || !year || !month || !day || hour === null) {
                alert('請填寫完整的出生資料');
                return;
            }

            // 使用資料庫中的範例數據（實際應用中這裡會是真正的計算邏輯）
            if (year === 1985 && month === 10 && day === 6 && hour === 19) {
                currentResult = DATABASE.sampleData;
                currentResult.basic_info.姓名 = name;
                currentResult.character_team.user_name = name;
            } else {
                // 對於其他日期，生成基本的結果結構
                currentResult = generateBasicResult(name, year, month, day, hour, minute);
            }
            
            displayResults();
            switchTab('team');
        }

        // 生成基本結果（簡化版）
        function generateBasicResult(name, year, month, day, hour, minute) {
            return {
                basic_info: {
                    姓名: name,
                    陽曆: `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')} ${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}:00`
                },
                character_team: {
                    user_name: name,
                    birth_info: `${year}年${month}月${day}日${hour}時`,
                    main_characters: [
                        {
                            pillar: "年柱",
                            role: "主將",
                            description: "領導統御",
                            element: "待計算",
                            attributes: { 魅力: 3, 統御: 3, 人脈: 2 },
                            skills: ["社交達人", "貴人相助", "團隊凝聚"],
                            background: "年柱代表家族傳承與早年環境，影響你的領導風格與人脈資源。"
                        },
                        {
                            pillar: "月柱", 
                            role: "軍師",
                            description: "智謀策略",
                            element: "待計算",
                            attributes: { 智力: 3, 策略: 3, 分析: 2 },
                            skills: ["策略制定", "風險分析", "決策支援"],
                            background: "月柱代表成長環境與學習能力，決定你的思維模式與策略制定能力。"
                        },
                        {
                            pillar: "日柱",
                            role: "副將", 
                            description: "執行力量",
                            element: "待計算",
                            attributes: { 力量: 4, 執行: 4, 堅韌: 3 },
                            skills: ["強力執行", "不屈意志", "突破障礙"],
                            background: "日柱代表核心自我與執行能力，是你最重要的力量來源。"
                        },
                        {
                            pillar: "時柱",
                            role: "士兵",
                            description: "基礎支援", 
                            element: "待計算",
                            attributes: { 體質: 3, 支援: 3, 財運: 3 },
                            skills: ["資源管理", "後勤支援", "財富積累"],
                            background: "時柱代表未來發展與子女運，影響你的後續發展潛力。"
                        }
                    ],
                    team_stats: {
                        總戰力: 80,
                        創意指數: 75,
                        財運指數: 70,
                        人脈指數: 75,
                        執行力: 80,
                        領導力: 75
                    }
                },
                life_strategy: {
                    事業發展: {
                        優勢領域: ["待分析"],
                        發展建議: ["請使用完整的八字計算獲得詳細建議"],
                        注意事項: ["建議進行完整的命理分析"]
                    }
                }
            };
        }

        // 顯示結果
        function displayResults() {
            if (!currentResult) return;

            displayTeam();
            displayStrategy();
            displayAnalysis();
        }

        // 顯示軍團
        function displayTeam() {
            const container = document.getElementById('team-display');
            const team = currentResult.character_team;
            
            let html = `
                <div class="character-card">
                    <div class="character-header">
                        <div class="character-title">👑 ${team.user_name} 的命運軍團</div>
                        <div class="character-role">${team.birth_info}</div>
                    </div>
                    
                    <div class="team-stats">
                        ${Object.entries(team.team_stats).map(([key, value]) => `
                            <div class="stat-item">
                                <div class="stat-name">${key}</div>
                                <div class="stat-value">${value}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // 顯示主要角色
            team.main_characters.forEach(character => {
                const mapping = DATABASE.legionMapping[character.pillar];
                html += `
                    <div class="character-card">
                        <div class="character-header">
                            <div class="character-title">${character.pillar} - ${character.element}</div>
                            <div class="character-role">${character.role}</div>
                        </div>
                        
                        <div class="character-details">
                            <div class="detail-section">
                                <div class="detail-title">🎯 角色屬性</div>
                                <div class="attributes-grid">
                                    ${Object.entries(character.attributes).map(([key, value]) => `
                                        <div class="attribute-item">
                                            <div class="attribute-name">${key}</div>
                                            <div class="attribute-value">${value}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="detail-section">
                                <div class="detail-title">⚔️ 專精技能</div>
                                <div class="skills-list">
                                    ${character.skills.map(skill => `
                                        <span class="skill-tag">${skill}</span>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                        
                        <div class="story-section">
                            <div class="story-title">🔮 命理詳情</div>
                            <div class="story-content">
                                <strong>天干十神：</strong>${currentResult.bazi_details && currentResult.bazi_details[character.pillar] ? currentResult.bazi_details[character.pillar].十神 : '待計算'}<br>
                                ${currentResult.bazi_details && currentResult.bazi_details[character.pillar] && currentResult.bazi_details[character.pillar].藏干十神 ? 
                                    `<strong>藏干十神：</strong>${currentResult.bazi_details[character.pillar].藏干十神.join('、')}<br>` : ''}
                                ${currentResult.bazi_details && currentResult.bazi_details[character.pillar] ? 
                                    `<strong>完整十神：</strong>${[currentResult.bazi_details[character.pillar].十神, ...(currentResult.bazi_details[character.pillar].藏干十神 || [])].join('、')}<br>` : ''}
                                ${currentResult.bazi_details && currentResult.bazi_details[character.pillar] && currentResult.bazi_details[character.pillar].神煞 ? 
                                    `<strong>神煞：</strong>${currentResult.bazi_details[character.pillar].神煞.join('、')}<br>` : ''}
                                ${currentResult.bazi_details && currentResult.bazi_details[character.pillar] ? 
                                    `<strong>納音：</strong>${currentResult.bazi_details[character.pillar].納音}` : ''}
                            </div>
                        </div>
                        
                        <div class="story-section">
                            <div class="story-title">📖 角色背景</div>
                            <div class="story-content">${character.background}</div>
                        </div>
                        
                        ${mapping ? `
                            <div class="story-section">
                                <div class="story-title">🎯 戰略職能</div>
                                <div class="story-content">
                                    <strong>軍團類型：</strong>${mapping.legion}<br>
                                    <strong>核心功能：</strong>${mapping.function}<br>
                                    <strong>作戰策略：</strong>${mapping.strategy}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // 顯示戰略
        function displayStrategy() {
            const container = document.getElementById('strategy-display');
            const strategy = currentResult.life_strategy;
            
            let html = '';
            
            Object.entries(strategy).forEach(([category, data]) => {
                html += `
                    <div class="character-card">
                        <div class="character-header">
                            <div class="character-title">📋 ${category}</div>
                        </div>
                        
                        <div class="character-details">
                `;
                
                Object.entries(data).forEach(([key, value]) => {
                    html += `
                        <div class="detail-section">
                            <div class="detail-title">${key}</div>
                            <div class="story-content">
                    `;
                    
                    if (Array.isArray(value)) {
                        html += `
                            <ul style="margin-left: 20px;">
                                ${value.map(item => `<li style="margin-bottom: 8px;">${item}</li>`).join('')}
                            </ul>
                        `;
                    } else {
                        html += value;
                    }
                    
                    html += `
                            </div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // 顯示分析
        function displayAnalysis() {
            const container = document.getElementById('analysis-display');
            const basic = currentResult.basic_info;
            const bazi = currentResult.bazi_details;
            
            let html = `
                <div class="character-card">
                    <div class="character-header">
                        <div class="character-title">📊 基本資訊</div>
                    </div>
                    
                    <div class="character-details">
                        <div class="detail-section">
                            <div class="detail-title">個人資料</div>
                            <div class="story-content">
                                ${Object.entries(basic).map(([key, value]) => `
                                    <strong>${key}：</strong>${value}<br>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            if (bazi) {
                html += `
                    <div class="character-card">
                        <div class="character-header">
                            <div class="character-title">🔮 四柱詳情</div>
                        </div>
                        
                        <div class="character-details">
                `;
                
                Object.entries(bazi).forEach(([pillar, data]) => {
                    html += `
                        <div class="detail-section">
                            <div class="detail-title">${pillar} - ${data.天干}${data.地支}</div>
                            <div class="story-content">
                                <strong>五行：</strong>${data.五行}<br>
                                <strong>納音：</strong>${data.納音}<br>
                                <strong>天干十神：</strong>${data.十神}<br>
                                ${data.藏干十神 ? `<strong>藏干十神：</strong>${data.藏干十神.join('、')}<br>` : ''}
                                <strong>完整十神：</strong>${[data.十神, ...(data.藏干十神 || [])].join('、')}<br>
                                <strong>神煞：</strong>${data.神煞 ? data.神煞.join('、') : '無'}<br>
                                <strong>藏干：</strong>${data.藏干 ? data.藏干.join('、') : '無'}
                            </div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }
    </script>
</body>
</html>

