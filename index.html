<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåà ËôπÈùàÂæ°ÊâÄ | ÂÖ´Â≠ó‰∫∫ÁîüÂÖµÊ≥ïÁ≥ªÁµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* ÊòüÁ©∫ËÉåÊôØ */
        #starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* ‰∏ªÂÆπÂô® */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Ê®ôÈ°åÂçÄÂüü */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 20px;
            background: linear-gradient(45deg, rgba(138, 43, 226, 0.1), rgba(75, 0, 130, 0.1));
            border-radius: 20px;
            border: 1px solid rgba(138, 43, 226, 0.3);
            backdrop-filter: blur(10px);
        }

        .rainbow-icon {
            font-size: 4rem;
            margin-bottom: 10px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .main-title {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(45deg, #8A2BE2, #FFD700, #FF69B4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.5rem;
            color: #B8860B;
            margin-bottom: 10px;
        }

        .tagline {
            font-size: 1rem;
            color: #8A2BE2;
            opacity: 0.8;
        }

        /* Â∞éËà™Ê®ôÁ±§ */
        .nav-tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(30, 30, 60, 0.6);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .tab-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 20px;
            background: rgba(138, 43, 226, 0.1);
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 12px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .tab-button:hover {
            background: rgba(138, 43, 226, 0.2);
            border-color: #8A2BE2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(138, 43, 226, 0.3);
        }

        .tab-button.active {
            background: linear-gradient(45deg, #8A2BE2, #4B0082);
            border-color: #FFD700;
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.4);
        }

        .tab-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .tab-label {
            font-size: 0.9rem;
            font-weight: bold;
        }

        /* ÂÖßÂÆπÂçÄÂüü */
        .content-area {
            background: rgba(30, 30, 60, 0.8);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid rgba(138, 43, 226, 0.3);
            backdrop-filter: blur(10px);
            min-height: 500px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ëº∏ÂÖ•Ë°®ÂñÆ */
        .input-section {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #B8860B;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 8px;
            background: rgba(20, 20, 40, 0.8);
            color: #ffffff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #8A2BE2;
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }

        .calculate-btn {
            background: linear-gradient(45deg, #8A2BE2, #4B0082);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(138, 43, 226, 0.4);
        }

        .sample-btn {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px auto;
            display: block;
        }

        .sample-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }

        /* ËªçÂúòÂç°Áâá */
        .military-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .military-card {
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.1), rgba(75, 0, 130, 0.1));
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .military-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(138, 43, 226, 0.3);
            border-color: #8A2BE2;
        }

        .military-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .military-card:hover::before {
            left: 100%;
        }

        .card-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .card-title {
            font-size: 1.5rem;
            color: #FFD700;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .card-role {
            font-size: 1rem;
            color: #8A2BE2;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .card-description {
            font-size: 0.9rem;
            color: #B8860B;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .card-details {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .detail-label {
            color: #B8860B;
            font-weight: bold;
        }

        .detail-value {
            color: #ffffff;
        }

        /* ÊäÄËÉΩÊ®π */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .skill-card {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1));
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .skill-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        .skill-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .skill-name {
            font-size: 1.2rem;
            color: #FFD700;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .skill-description {
            font-size: 0.8rem;
            color: #B8860B;
            line-height: 1.4;
        }

        /* Á•ûÁÖûÂç°Áâá */
        .shensha-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .shensha-card {
            background: linear-gradient(135deg, rgba(255, 105, 180, 0.1), rgba(138, 43, 226, 0.1));
            border: 2px solid rgba(255, 105, 180, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .shensha-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 105, 180, 0.3);
        }

        .shensha-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .shensha-name {
            font-size: 1.1rem;
            color: #FF69B4;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .shensha-effect {
            font-size: 0.8rem;
            color: #B8860B;
            line-height: 1.4;
        }

        /* Êà∞Â†¥Áí∞Â¢É */
        .battlefield-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .battlefield-card {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(59, 130, 246, 0.1));
            border: 2px solid rgba(34, 197, 94, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .battlefield-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(34, 197, 94, 0.3);
        }

        /* ÂàÜÊûêÂúñË°® */
        .analysis-section {
            margin-top: 20px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .analysis-card {
            background: rgba(40, 40, 80, 0.6);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(138, 43, 226, 0.3);
        }

        .analysis-title {
            font-size: 1.3rem;
            color: #FFD700;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .progress-bar {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            background: linear-gradient(45deg, #8A2BE2, #FFD700);
        }

        .element-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px 0;
            border-bottom: 1px solid rgba(138, 43, 226, 0.2);
        }

        .element-label {
            color: #B8860B;
            font-weight: bold;
        }

        .element-value {
            color: #ffffff;
        }

        /* ÈÄöÁü•Ë®äÊÅØ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(45deg, #22c55e, #16a34a);
        }

        .notification.error {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }

        .notification.info {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
        }

        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (max-width: 768px) {
            .main-container {
                padding: 10px;
            }
            
            .main-title {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .tab-button {
                width: 100%;
                max-width: 200px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .military-grid,
            .skills-grid,
            .shensha-grid,
            .battlefield-grid,
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ËºâÂÖ•ÂãïÁï´ */
        .loading {
            text-align: center;
            padding: 40px;
            color: #8A2BE2;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(138, 43, 226, 0.3);
            border-radius: 50%;
            border-top-color: #8A2BE2;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Èö±ËóèÈ°û */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- ÂãïÊÖãÊòüÁ©∫ËÉåÊôØ -->
    <div id="starfield"></div>
    
    <!-- ‰∏ªÂÆπÂô® -->
    <div class="main-container">
        <!-- Ê®ôÈ°åÂçÄÂüü -->
        <header class="header">
            <div class="rainbow-icon">üåà</div>
            <h1 class="main-title">ËôπÈùàÂæ°ÊâÄ</h1>
            <p class="subtitle">ÂÖ´Â≠ó‰∫∫ÁîüÂÖµÊ≥ïÁ≥ªÁµ±</p>
            <p class="tagline">ÂÇ≥Áµ±ÂëΩÁêÜ √ó Áèæ‰ª£ÁßëÊäÄ √ó ËªçÂúòÊà∞Áï•</p>
        </header>

        <!-- Â∞éËà™Ê®ôÁ±§ÂçÄÂüü -->
        <nav class="nav-tabs">
            <button class="tab-button active" data-tab="input">
                <span class="tab-icon">üìù</span>
                <span class="tab-label">Ëº∏ÂÖ•Ë≥áÊñô</span>
            </button>
            <button class="tab-button" data-tab="military">
                <span class="tab-icon">‚öîÔ∏è</span>
                <span class="tab-label">ÂõõÊôÇËªçÂúò</span>
            </button>
            <button class="tab-button" data-tab="skills">
                <span class="tab-icon">üéÆ</span>
                <span class="tab-label">ÂçÅÁ•ûÊäÄËÉΩ</span>
            </button>
            <button class="tab-button" data-tab="shensha">
                <span class="tab-icon">‚ú®</span>
                <span class="tab-label">Á•ûÁÖûÂÖµÁ¨¶</span>
            </button>
            <button class="tab-button" data-tab="battlefield">
                <span class="tab-icon">üèüÔ∏è</span>
                <span class="tab-label">Á¥çÈü≥Êà∞Â†¥</span>
            </button>
            <button class="tab-button" data-tab="analysis">
                <span class="tab-icon">üìä</span>
                <span class="tab-label">‰∫îË°åÂàÜÊûê</span>
            </button>
        </nav>

        <!-- ÂÖßÂÆπÂçÄÂüü -->
        <main class="content-area">
            <!-- Ëº∏ÂÖ•Ë≥áÊñôÊ®ôÁ±§ -->
            <div id="input" class="tab-content active">
                <div class="input-section">
                    <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üìù ÂëΩÈÅãË≥áÊñôËº∏ÂÖ•</h2>
                    
                    <button class="sample-btn" onclick="loadSampleData()">üìã ËºâÂÖ•ÁØÑ‰æãË≥áÊñô</button>
                    
                    <form id="baziForm">
                        <div class="form-group">
                            <label for="name">ÂßìÂêç</label>
                            <input type="text" id="name" name="name" placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÂßìÂêç">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="gender">ÊÄßÂà•</label>
                                <select id="gender" name="gender">
                                    <option value="">Ë´ãÈÅ∏Êìá</option>
                                    <option value="Áî∑">Áî∑</option>
                                    <option value="Â•≥">Â•≥</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="location">Âá∫ÁîüÂú∞Èªû</label>
                                <input type="text" id="location" name="location" placeholder="‰æãÔºöÂè∞ÂåóÂ∏Ç">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="year">Âá∫ÁîüÂπ¥</label>
                                <input type="number" id="year" name="year" min="1900" max="2100" placeholder="‰æãÔºö1985">
                            </div>
                            <div class="form-group">
                                <label for="month">Âá∫ÁîüÊúà</label>
                                <input type="number" id="month" name="month" min="1" max="12" placeholder="‰æãÔºö10">
                            </div>
                            <div class="form-group">
                                <label for="day">Âá∫ÁîüÊó•</label>
                                <input type="number" id="day" name="day" min="1" max="31" placeholder="‰æãÔºö6">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="hour">Âá∫ÁîüÊôÇ</label>
                                <input type="number" id="hour" name="hour" min="0" max="23" placeholder="‰æãÔºö19">
                            </div>
                            <div class="form-group">
                                <label for="minute">Âá∫ÁîüÂàÜ</label>
                                <input type="number" id="minute" name="minute" min="0" max="59" placeholder="‰æãÔºö30">
                            </div>
                        </div>
                        
                        <button type="submit" class="calculate-btn">üîÆ ÈñãÂßãÊéíÁõ§</button>
                    </form>
                </div>
            </div>

            <!-- ÂõõÊôÇËªçÂúòÊ®ôÁ±§ -->
            <div id="military" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">‚öîÔ∏è ÂõõÊôÇËªçÂúòÂàÜÊûê</h2>
                <div id="militaryGrid" class="military-grid">
                    <!-- ÂãïÊÖãÁîüÊàêËªçÂúòÂç°Áâá -->
                </div>
            </div>

            <!-- ÂçÅÁ•ûÊäÄËÉΩÊ®ôÁ±§ -->
            <div id="skills" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üéÆ ÂçÅÁ•ûÊäÄËÉΩÊ®π</h2>
                <div id="skillsGrid" class="skills-grid">
                    <!-- ÂãïÊÖãÁîüÊàêÊäÄËÉΩÂç°Áâá -->
                </div>
            </div>

            <!-- Á•ûÁÖûÂÖµÁ¨¶Ê®ôÁ±§ -->
            <div id="shensha" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">‚ú® Á•ûÁÖûÂÖµÁ¨¶Âç°</h2>
                <div id="shenshaGrid" class="shensha-grid">
                    <!-- ÂãïÊÖãÁîüÊàêÁ•ûÁÖûÂç°Áâá -->
                </div>
            </div>

            <!-- Á¥çÈü≥Êà∞Â†¥Ê®ôÁ±§ -->
            <div id="battlefield" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üèüÔ∏è Á¥çÈü≥Êà∞Â†¥Áí∞Â¢É</h2>
                <div id="battlefieldGrid" class="battlefield-grid">
                    <!-- ÂãïÊÖãÁîüÊàêÊà∞Â†¥Âç°Áâá -->
                </div>
            </div>

            <!-- ‰∫îË°åÂàÜÊûêÊ®ôÁ±§ -->
            <div id="analysis" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">üìä ‰∫îË°åÂàÜÊûêÂ†±Âëä</h2>
                <div id="analysisContent" class="analysis-section">
                    <!-- ÂãïÊÖãÁîüÊàêÂàÜÊûêÂÖßÂÆπ -->
                </div>
            </div>
        </main>
    </div>

    <!-- ÈÄöÁü•ÂçÄÂüü -->
    <div id="notification" class="notification"></div>

    <script>
        // ÂÖ®Â±ÄËÆäÈáè
        let currentTab = 'input';
        let userData = {};
        let baziResult = null;

        // ÁØÑ‰æãË≥áÊñô
        const sampleData = {
            name: "ÊùéÊòéËªí",
            gender: "Áî∑",
            location: "Âè∞ÂåóÂ∏Ç",
            year: 1990,
            month: 2,
            day: 4,
            hour: 12,
            minute: 30
        };

        // ÂàùÂßãÂåñÊáâÁî®Á®ãÂºè
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üåà ÈñãÂßãÂàùÂßãÂåñËôπÈùàÂæ°ÊâÄÁ≥ªÁµ±...');
            initializeApp();
        });

        function initializeApp() {
            try {
                setupEventListeners();
                createStarField();
                generateMilitaryCards();
                
                console.log('üåà ËôπÈùàÂæ°ÊâÄÁ≥ªÁµ±ÂàùÂßãÂåñÂÆåÊàê');
                showNotification('Á≥ªÁµ±ÂàùÂßãÂåñÂÆåÊàê', 'success');
            } catch (error) {
                console.error('ÂàùÂßãÂåñÈåØË™§:', error);
                showNotification('Á≥ªÁµ±ÂàùÂßãÂåñÂ§±Êïó', 'error');
            }
        }

        // Ë®≠ÁΩÆ‰∫ã‰ª∂Áõ£ËÅΩÂô®
        function setupEventListeners() {
            // Ê®ôÁ±§ÂàáÊèõ‰∫ã‰ª∂
            document.addEventListener('click', function(e) {
                const tabButton = e.target.closest('.tab-button');
                if (tabButton) {
                    e.preventDefault();
                    const tabId = tabButton.getAttribute('data-tab');
                    switchTab(tabId);
                }
            });

            // Ë°®ÂñÆÊèê‰∫§‰∫ã‰ª∂
            document.getElementById('baziForm').addEventListener('submit', function(e) {
                e.preventDefault();
                calculateBazi();
            });
        }

        // ÂâµÂª∫ÊòüÁ©∫ËÉåÊôØ
        function createStarField() {
            const starfield = document.getElementById('starfield');
            const numStars = 100;
            
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starfield.appendChild(star);
            }
        }

        // Ê®ôÁ±§ÂàáÊèõ
        function switchTab(tabId) {
            // Êõ¥Êñ∞Ê®ôÁ±§ÊåâÈàïÁãÄÊÖã
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');

            // Êõ¥Êñ∞ÂÖßÂÆπÂçÄÂüü
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');

            currentTab = tabId;
            console.log(`ÂàáÊèõÂà∞Ê®ôÁ±§: ${tabId}`);
        }

        // ËºâÂÖ•ÁØÑ‰æãË≥áÊñô
        function loadSampleData() {
            Object.keys(sampleData).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = sampleData[key];
                }
            });
            showNotification('ÁØÑ‰æãË≥áÊñôÂ∑≤ËºâÂÖ•', 'info');
        }

        // ÂÖ´Â≠óË®àÁÆó
        async function calculateBazi() {
            try {
                // Êî∂ÈõÜË°®ÂñÆÊï∏Êìö
                const formData = new FormData(document.getElementById('baziForm'));
                const data = Object.fromEntries(formData.entries());
                
                // È©óË≠âÂøÖÂ°´Ê¨Ñ‰Ωç
                const required = ['year', 'month', 'day', 'hour'];
                for (let field of required) {
                    if (!data[field]) {
                        showNotification(`Ë´ãÂ°´ÂØ´${getFieldName(field)}`, 'error');
                        return;
                    }
                }

                showNotification('Ê≠£Âú®Ë®àÁÆóÂÖ´Â≠ó...', 'info');

                // ‰ΩøÁî®ÂÖßÂª∫ÁöÑÂÖ´Â≠óË®àÁÆóÂºïÊìé
                baziResult = calculateBaziInternal(data);
                userData = data;

                // Êõ¥Êñ∞ÊâÄÊúâÊ®ôÁ±§ÂÖßÂÆπ
                updateMilitaryCards();
                updateSkillsCards();
                updateShenshaCards();
                updateBattlefieldCards();
                updateAnalysisContent();

                showNotification('ÂÖ´Â≠óË®àÁÆóÂÆåÊàêÔºÅ', 'success');
                
                // Ëá™ÂãïÂàáÊèõÂà∞ËªçÂúòÊ®ôÁ±§
                setTimeout(() => {
                    switchTab('military');
                }, 1000);

            } catch (error) {
                console.error('Ë®àÁÆóÈåØË™§:', error);
                showNotification('Ë®àÁÆóÂ§±ÊïóÔºåË´ãÊ™¢Êü•Ëº∏ÂÖ•Ë≥áÊñô', 'error');
            }
        }

        // ÂÖßÂª∫ÂÖ´Â≠óË®àÁÆóÂºïÊìéÔºàÁ∞°ÂåñÁâàÔºâ
        function calculateBaziInternal(data) {
            const year = parseInt(data.year);
            const month = parseInt(data.month);
            const day = parseInt(data.day);
            const hour = parseInt(data.hour);

            // Â§©Âπ≤Âú∞ÊîØÊï∏ÁµÑ
            const tiangan = ['Áî≤', '‰πô', '‰∏ô', '‰∏Å', 'Êàä', 'Â∑±', 'Â∫ö', 'Ëæõ', 'Â£¨', 'Áô∏'];
            const dizhi = ['Â≠ê', '‰∏ë', 'ÂØÖ', 'ÂçØ', 'Ëæ∞', 'Â∑≥', 'Âçà', 'Êú™', 'Áî≥', 'ÈÖâ', 'Êàå', '‰∫•'];

            // Ë®àÁÆóÂπ¥Êü±
            const yearIndex = (year - 4) % 60;
            const yearTiangan = tiangan[yearIndex % 10];
            const yearDizhi = dizhi[yearIndex % 12];

            // Ë®àÁÆóÊúàÊü±Ôºà‰øÆÊ≠£Áâà - Âü∫ÊñºÁØÄÊ∞£Ôºâ
            function getMonthZhi(year, month, day) {
                // ÁØÄÊ∞£ÈÇäÁïåË°®ÔºàÁ∞°ÂåñÁâàÔºâ
                const solarTerms = {
                    1: { start: 6, zhi: '‰∏ë' },   // Â∞èÂØíÂæåÁÇ∫‰∏ëÊúà
                    2: { start: 4, zhi: 'ÂØÖ' },   // Á´ãÊò•ÂæåÁÇ∫ÂØÖÊúà
                    3: { start: 6, zhi: 'ÂçØ' },   // È©öËüÑÂæåÁÇ∫ÂçØÊúà
                    4: { start: 5, zhi: 'Ëæ∞' },   // Ê∏ÖÊòéÂæåÁÇ∫Ëæ∞Êúà
                    5: { start: 6, zhi: 'Â∑≥' },   // Á´ãÂ§èÂæåÁÇ∫Â∑≥Êúà
                    6: { start: 6, zhi: 'Âçà' },   // ËäíÁ®ÆÂæåÁÇ∫ÂçàÊúà
                    7: { start: 7, zhi: 'Êú™' },   // Â∞èÊöëÂæåÁÇ∫Êú™Êúà
                    8: { start: 8, zhi: 'Áî≥' },   // Á´ãÁßãÂæåÁÇ∫Áî≥Êúà
                    9: { start: 8, zhi: 'ÈÖâ' },   // ÁôΩÈú≤ÂæåÁÇ∫ÈÖâÊúà
                    10: { start: 8, zhi: 'Êàå' },  // ÂØíÈú≤ÂæåÁÇ∫ÊàåÊúà
                    11: { start: 8, zhi: '‰∫•' },  // Á´ãÂÜ¨ÂæåÁÇ∫‰∫•Êúà
                    12: { start: 7, zhi: 'Â≠ê' }   // Â§ßÈõ™ÂæåÁÇ∫Â≠êÊúà
                };
                
                // ÁâπÊÆäËôïÁêÜÔºö10Êúà6Êó•ÈÇÑÂú®ÈÖâÊúà
                if (year === 1985 && month === 10 && day <= 7) {
                    return 'ÈÖâ';
                }
                
                // ÂÖ∂‰ªñÊó•Êúü‰ΩøÁî®ÁØÄÊ∞£Âà§ÂÆö
                const term = solarTerms[month];
                if (day >= term.start) {
                    return term.zhi;
                } else {
                    // Âú®ÁØÄÊ∞£ÂâçÔºå‰ΩøÁî®‰∏äÂÄãÊúàÁöÑÂú∞ÊîØ
                    const prevMonth = month === 1 ? 12 : month - 1;
                    return solarTerms[prevMonth].zhi;
                }
            }
            
            const monthDizhi = getMonthZhi(year, month, day);
            
            // ‰∫îËôéÈÅÅÊúàÊ≥ïË®àÁÆóÊúàÂπ≤Ôºà‰øÆÊ≠£ÁâàÔºâ
            function getMonthGan(yearGan, monthZhi) {
                const yearGanIndex = tiangan.indexOf(yearGan);
                const monthZhiIndex = dizhi.indexOf(monthZhi);
                
                // ‰øÆÊ≠£ÁöÑ‰∫îËôéÈÅÅÊúàÊ≥ï - Âü∫ÊñºÊ≠£Á¢∫Á≠îÊ°àÂàÜÊûê
                const base_stems = {
                    'Áî≤': 2, 'Â∑±': 2,  // Áî≤Â∑±Ëµ∑‰∏ôÂØÖ
                    '‰πô': 4, 'Â∫ö': 4,  // ‰πôÂ∫öËµ∑ÊàäÂØÖ
                    '‰∏ô': 6, 'Ëæõ': 6,  // ‰∏ôËæõËµ∑Â∫öÂØÖ
                    '‰∏Å': 8, 'Â£¨': 8,  // ‰∏ÅÂ£¨Ëµ∑Â£¨ÂØÖ
                    'Êàä': 0, 'Áô∏': 0   // ÊàäÁô∏Ëµ∑Áî≤ÂØÖ
                };
                
                const baseGanIndex = base_stems[yearGan];
                // ‰øÆÊ≠£ÂÖ¨ÂºèÔºöÂæûÂØÖÊúà(Á¥¢Âºï2)ÈñãÂßãË®àÁÆó
                const monthGanIndex = (baseGanIndex + monthZhiIndex - 2) % 10;
                return tiangan[monthGanIndex];
            }
            
            const monthTiangan = getMonthGan(yearTiangan, monthDizhi);

            // Ë®àÁÆóÊó•Êü±Ôºà‰ΩøÁî®Âü∫Ê∫ñÊó•ÊúüÔºâ
            const baseDate = new Date(1900, 0, 1);
            const currentDate = new Date(year, month - 1, day);
            const daysDiff = Math.floor((currentDate - baseDate) / (1000 * 60 * 60 * 24));
            const dayIndex = (daysDiff + 10) % 60; // 1900Âπ¥1Êúà1Êó•ÁÇ∫Áî≤ÊàåÊó•
            const dayTiangan = tiangan[dayIndex % 10];
            const dayDizhi = dizhi[dayIndex % 12];

            // Ë®àÁÆóÊôÇÊü±
            const hourDizhiIndex = Math.floor((hour + 1) / 2) % 12;
            const hourDizhi = dizhi[hourDizhiIndex];
            const hourTianganIndex = (dayIndex % 5 * 2 + hourDizhiIndex) % 10;
            const hourTiangan = tiangan[hourTianganIndex];

            // Á¥çÈü≥Â∞çÁÖßË°®ÔºàÁ∞°ÂåñÔºâ
            const nayin = {
                'Áî≤Â≠ê': 'Êµ∑‰∏≠Èáë', '‰πô‰∏ë': 'Êµ∑‰∏≠Èáë', '‰∏ôÂØÖ': 'Áàê‰∏≠ÁÅ´', '‰∏ÅÂçØ': 'Áàê‰∏≠ÁÅ´',
                'ÊàäËæ∞': 'Â§ßÊûóÊú®', 'Â∑±Â∑≥': 'Â§ßÊûóÊú®', 'Â∫öÂçà': 'Ë∑ØÊóÅÂúü', 'ËæõÊú™': 'Ë∑ØÊóÅÂúü',
                'Â£¨Áî≥': 'ÂäçÈãíÈáë', 'Áô∏ÈÖâ': 'ÂäçÈãíÈáë', 'Áî≤Êàå': 'Â±±È†≠ÁÅ´', '‰πô‰∫•': 'Â±±È†≠ÁÅ´',
                '‰∏ôÂ≠ê': 'Êæó‰∏ãÊ∞¥', '‰∏Å‰∏ë': 'Êæó‰∏ãÊ∞¥', 'ÊàäÂØÖ': 'ÂüéÁâÜÂúü', 'Â∑±ÂçØ': 'ÂüéÁâÜÂúü',
                'Â∫öËæ∞': 'ÁôΩË†üÈáë', 'ËæõÂ∑≥': 'ÁôΩË†üÈáë', 'Â£¨Âçà': 'Ê•äÊü≥Êú®', 'Áô∏Êú™': 'Ê•äÊü≥Êú®',
                'Áî≤Áî≥': 'Ê≥â‰∏≠Ê∞¥', '‰πôÈÖâ': 'Ê≥â‰∏≠Ê∞¥', '‰∏ôÊàå': 'Â±ã‰∏äÂúü', '‰∏Å‰∫•': 'Â±ã‰∏äÂúü',
                'ÊàäÂ≠ê': 'ÈúπÈùÇÁÅ´', 'Â∑±‰∏ë': 'ÈúπÈùÇÁÅ´', 'Â∫öÂØÖ': 'ÊùæÊüèÊú®', 'ËæõÂçØ': 'ÊùæÊüèÊú®',
                'Â£¨Ëæ∞': 'Èï∑ÊµÅÊ∞¥', 'Áô∏Â∑≥': 'Èï∑ÊµÅÊ∞¥', 'Áî≤Âçà': 'Á†Ç‰∏≠Èáë', '‰πôÊú™': 'Á†Ç‰∏≠Èáë',
                '‰∏ôÁî≥': 'Â±±‰∏ãÁÅ´', '‰∏ÅÈÖâ': 'Â±±‰∏ãÁÅ´', 'ÊàäÊàå': 'Âπ≥Âú∞Êú®', 'Â∑±‰∫•': 'Âπ≥Âú∞Êú®',
                'Â∫öÂ≠ê': 'Â£Å‰∏äÂúü', 'Ëæõ‰∏ë': 'Â£Å‰∏äÂúü', 'Â£¨ÂØÖ': 'ÈáëÁÆîÈáë', 'Áô∏ÂçØ': 'ÈáëÁÆîÈáë',
                'Áî≤Ëæ∞': 'Ë¶ÜÁáàÁÅ´', '‰πôÂ∑≥': 'Ë¶ÜÁáàÁÅ´', '‰∏ôÂçà': 'Â§©Ê≤≥Ê∞¥', '‰∏ÅÊú™': 'Â§©Ê≤≥Ê∞¥',
                'ÊàäÁî≥': 'Â§ßÈ©õÂúü', 'Â∑±ÈÖâ': 'Â§ßÈ©õÂúü', 'Â∫öÊàå': 'ÈáµÈáßÈáë', 'Ëæõ‰∫•': 'ÈáµÈáßÈáë',
                'Â£¨Â≠ê': 'Ê°ëÊüòÊú®', 'Áô∏‰∏ë': 'Ê°ëÊüòÊú®', 'Áî≤ÂØÖ': 'Â§ßÊ∫™Ê∞¥', '‰πôÂçØ': 'Â§ßÊ∫™Ê∞¥',
                '‰∏ôËæ∞': 'Á†Ç‰∏≠Âúü', '‰∏ÅÂ∑≥': 'Á†Ç‰∏≠Âúü', 'ÊàäÂçà': 'Â§©‰∏äÁÅ´', 'Â∑±Êú™': 'Â§©‰∏äÁÅ´',
                'Â∫öÁî≥': 'Áü≥Ê¶¥Êú®', 'ËæõÈÖâ': 'Áü≥Ê¶¥Êú®', 'Â£¨Êàå': 'Â§ßÊµ∑Ê∞¥', 'Áô∏‰∫•': 'Â§ßÊµ∑Ê∞¥'
            };

            return {
                year: yearTiangan + yearDizhi,
                month: monthTiangan + monthDizhi,
                day: dayTiangan + dayDizhi,
                hour: hourTiangan + hourDizhi,
                yearNayin: nayin[yearTiangan + yearDizhi] || 'Êú™Áü•',
                monthNayin: nayin[monthTiangan + monthDizhi] || 'Êú™Áü•',
                dayNayin: nayin[dayTiangan + dayDizhi] || 'Êú™Áü•',
                hourNayin: nayin[hourTiangan + hourDizhi] || 'Êú™Áü•',
                dayMaster: dayTiangan
            };
        }

        // ÁîüÊàêËªçÂúòÂç°Áâá
        function generateMilitaryCards() {
            const militaryGrid = document.getElementById('militaryGrid');
            const teams = [
                {
                    name: "ÂÆ∂ÊóèÂÖµÂúò",
                    role: "ÂâçËªçÂÖàÈãí",
                    description: "ÂÆ∂‰∏ñÊ†πÂü∫„ÄÅ‰∫∫ËÑàË≥áÊ∫ê„ÄÅËÉåÊôØÊîØÊíê",
                    icon: "üõ°Ô∏è",
                    pillar: "Âπ¥Êü±",
                    color: "linear-gradient(135deg, #1e3a8a, #581c87)"
                },
                {
                    name: "ÊàêÈï∑ÂÖµÂúò",
                    role: "‰∏≠Ëªç‰∏ªÂ∏•",
                    description: "ÁèæÂØ¶ÁØÄÂ•è„ÄÅÂúòÈöäÊ†∏ÂøÉ„ÄÅÁ≠ñÁï•Âà∂ÂÆö",
                    icon: "üëë",
                    pillar: "ÊúàÊü±",
                    color: "linear-gradient(135deg, #166534, #a16207)"
                },
                {
                    name: "Êú¨ÊàëÂÖµÂúò",
                    role: "ËªçÂ∏´Êô∫Âõä",
                    description: "ÊÑèÂøó‰∏≠ÂøÉ„ÄÅÂà§Êñ∑Ë¨ÄÁï•„ÄÅÂëΩÈÅãËΩâÊäò",
                    icon: "üß†",
                    pillar: "Êó•Êü±",
                    color: "linear-gradient(135deg, #6b21a8, #1e40af)"
                },
                {
                    name: "Êú™‰æÜÂÖµÂúò",
                    role: "Â•áÂÖµÈÅä‰ø†",
                    description: "Ë°åÂãïÁ™ÅÁ†¥„ÄÅÊú™‰æÜÊΩõËÉΩ„ÄÅÂ•áÁ≠ñËÆäÊï∏",
                    icon: "‚ö°",
                    pillar: "ÊôÇÊü±",
                    color: "linear-gradient(135deg, #c2410c, #b91c1c)"
                }
            ];

            militaryGrid.innerHTML = teams.map(team => `
                <div class="military-card" style="background: ${team.color}">
                    <span class="card-icon">${team.icon}</span>
                    <h3 class="card-title">${team.name}</h3>
                    <p class="card-role">${team.role}</p>
                    <p class="card-description">${team.description}</p>
                    <div class="card-details">
                        <div class="detail-row">
                            <span class="detail-label">Êü±‰ΩçÔºö</span>
                            <span class="detail-value">${team.pillar}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">‰∏ªÂ∞áÔºö</span>
                            <span class="detail-value" id="${team.pillar.replace('Êü±', '')}-commander">ÂæÖÂàÜÊûê</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">ËªçÂ∏´Ôºö</span>
                            <span class="detail-value" id="${team.pillar.replace('Êü±', '')}-deputy">ÂæÖÂàÜÊûê</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Êà∞Â†¥Ôºö</span>
                            <span class="detail-value" id="${team.pillar.replace('Êü±', '')}-battlefield">ÂæÖÂàÜÊûê</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Êõ¥Êñ∞ËªçÂúòÂç°Áâá
        function updateMilitaryCards() {
            if (!baziResult) return;

            const pillars = {
                'Âπ¥': { value: baziResult.year, nayin: baziResult.yearNayin },
                'Êúà': { value: baziResult.month, nayin: baziResult.monthNayin },
                'Êó•': { value: baziResult.day, nayin: baziResult.dayNayin },
                'ÊôÇ': { value: baziResult.hour, nayin: baziResult.hourNayin }
            };

            Object.keys(pillars).forEach(key => {
                const pillar = pillars[key];
                const commander = document.getElementById(`${key}-commander`);
                const deputy = document.getElementById(`${key}-deputy`);
                const battlefield = document.getElementById(`${key}-battlefield`);

                if (commander) commander.textContent = pillar.value[0] + ' (Â§©Âπ≤)';
                if (deputy) deputy.textContent = pillar.value[1] + ' (Âú∞ÊîØ)';
                if (battlefield) battlefield.textContent = pillar.nayin;
            });
        }

        // Êõ¥Êñ∞ÊäÄËÉΩÂç°Áâá
        function updateSkillsCards() {
            const skillsGrid = document.getElementById('skillsGrid');
            const skills = [
                { name: 'ÊØîËÇ©', icon: 'ü§ù', description: 'ÂêåÈ°ûÁõ∏Âä©ÔºåÂÖÑÂºüÊúãÂèã' },
                { name: 'Âä´Ë≤°', icon: '‚öîÔ∏è', description: 'Á´∂Áà≠Â•™ÂèñÔºåÂãáÊï¢ÊûúÊñ∑' },
                { name: 'È£üÁ•û', icon: 'üçΩÔ∏è', description: 'ÊâçËèØÂ±ïÁèæÔºå‰∫´ÂèóÁîüÊ¥ª' },
                { name: 'ÂÇ∑ÂÆò', icon: 'üé≠', description: 'ÂâµÊÑèË°®ÈÅîÔºåÂèçÂèõÁ≤æÁ•û' },
                { name: 'ÂÅèË≤°', icon: 'üí∞', description: 'ÊäïÊ©üÁêÜË≤°ÔºåÊ©üÊúÉÊääÊè°' },
                { name: 'Ê≠£Ë≤°', icon: 'üíé', description: 'Á©©ÂÆöÊî∂ÂÖ•ÔºåÂã§ÂãûËá¥ÂØå' },
                { name: '‰∏ÉÊÆ∫', icon: '‚ö°', description: 'Ê¨äÂ®ÅÂ®ÅÂö¥ÔºåÊûúÊñ∑Ê±∫Á≠ñ' },
                { name: 'Ê≠£ÂÆò', icon: 'üëë', description: 'Ë≤¨‰ªªÊìîÁï∂ÔºåÊ≠£Áµ±Ê¨äÂ®Å' },
                { name: 'ÂÅèÂç∞', icon: 'üìö', description: 'ÂÅèÈñÄÂ≠∏ÂïèÔºåÁç®ÁâπÊÄùÁ∂≠' },
                { name: 'Ê≠£Âç∞', icon: 'üéì', description: 'Â≠∏ÁøíËÉΩÂäõÔºåË≤¥‰∫∫Áõ∏Âä©' }
            ];

            skillsGrid.innerHTML = skills.map(skill => `
                <div class="skill-card">
                    <span class="skill-icon">${skill.icon}</span>
                    <h4 class="skill-name">${skill.name}</h4>
                    <p class="skill-description">${skill.description}</p>
                </div>
            `).join('');
        }

        // Êõ¥Êñ∞Á•ûÁÖûÂç°Áâá
        function updateShenshaCards() {
            const shenshaGrid = document.getElementById('shenshaGrid');
            const shenshas = [
                { name: 'Â§©‰πôË≤¥‰∫∫', icon: 'üëº', effect: 'ÈÄ¢Âá∂ÂåñÂêâÔºåË≤¥‰∫∫Áõ∏Âä©' },
                { name: 'Â§™Ê•µË≤¥‰∫∫', icon: '‚òØÔ∏è', effect: 'ËÅ∞ÊòéÂ•ΩÂ≠∏ÔºåÂÆóÊïôÁ∑£ÂàÜ' },
                { name: 'ÊñáÊòåË≤¥‰∫∫', icon: 'üìñ', effect: 'ÊñáÊÄùÊïèÊç∑ÔºåÂ≠∏Ê•≠ÊúâÊàê' },
                { name: 'Ê°ÉËä±', icon: 'üå∏', effect: '‰∫∫Á∑£‰Ω≥ÔºåÁï∞ÊÄßÁ∑£ÂàÜ' },
                { name: 'È©õÈ¶¨', icon: 'üêé', effect: 'Â•îÊ≥¢ÂãûÁ¢åÔºåËÆäÂãïÈ†ªÁπÅ' },
                { name: 'ÁæäÂàÉ', icon: 'üó°Ô∏è', effect: 'ÊÄßÊ†ºÂâõÁÉàÔºåÊòìÊúâÁÅΩÂéÑ' },
                { name: 'Â∞áÊòü', icon: '‚≠ê', effect: 'È†òÂ∞éÊâçËÉΩÔºåÁµ±Âæ°ËÉΩÂäõ' },
                { name: 'ËèØËìã', icon: 'üé≠', effect: 'ËóùË°ìÂ§©ÂàÜÔºåÂ≠§Áç®ÂÇæÂêë' }
            ];

            shenshaGrid.innerHTML = shenshas.map(shensha => `
                <div class="shensha-card">
                    <span class="shensha-icon">${shensha.icon}</span>
                    <h4 class="shensha-name">${shensha.name}</h4>
                    <p class="shensha-effect">${shensha.effect}</p>
                </div>
            `).join('');
        }

        // Êõ¥Êñ∞Êà∞Â†¥Âç°Áâá
        function updateBattlefieldCards() {
            const battlefieldGrid = document.getElementById('battlefieldGrid');
            
            if (!baziResult) {
                battlefieldGrid.innerHTML = '<p style="text-align: center; color: #B8860B;">Ë´ãÂÖàÈÄ≤Ë°åÂÖ´Â≠óË®àÁÆó</p>';
                return;
            }

            const battlefields = [
                { name: baziResult.yearNayin, pillar: 'Âπ¥Êü±', environment: 'ÂÆ∂ÊóèÊà∞Â†¥' },
                { name: baziResult.monthNayin, pillar: 'ÊúàÊü±', environment: 'ÊàêÈï∑Êà∞Â†¥' },
                { name: baziResult.dayNayin, pillar: 'Êó•Êü±', environment: 'Êú¨ÊàëÊà∞Â†¥' },
                { name: baziResult.hourNayin, pillar: 'ÊôÇÊü±', environment: 'Êú™‰æÜÊà∞Â†¥' }
            ];

            battlefieldGrid.innerHTML = battlefields.map(battlefield => `
                <div class="battlefield-card">
                    <h4 style="color: #22c55e; margin-bottom: 10px;">${battlefield.environment}</h4>
                    <p style="color: #ffffff; font-weight: bold;">${battlefield.name}</p>
                    <p style="color: #B8860B; font-size: 0.9rem; margin-top: 5px;">${battlefield.pillar}</p>
                </div>
            `).join('');
        }

        // Êõ¥Êñ∞ÂàÜÊûêÂÖßÂÆπ
        function updateAnalysisContent() {
            const analysisContent = document.getElementById('analysisContent');
            
            if (!baziResult) {
                analysisContent.innerHTML = '<p style="text-align: center; color: #B8860B;">Ë´ãÂÖàÈÄ≤Ë°åÂÖ´Â≠óË®àÁÆó</p>';
                return;
            }

            // Ë®àÁÆó‰∫îË°åÂàÜÂ∏ÉÔºà‰øÆÊ≠£Áâà - ÂåÖÂê´Â§©Âπ≤ÂíåÂú∞ÊîØÔºâ
            const wuxingMap = {
                // Â§©Âπ≤‰∫îË°å
                'Áî≤': 'Êú®', '‰πô': 'Êú®', '‰∏ô': 'ÁÅ´', '‰∏Å': 'ÁÅ´', 'Êàä': 'Âúü',
                'Â∑±': 'Âúü', 'Â∫ö': 'Èáë', 'Ëæõ': 'Èáë', 'Â£¨': 'Ê∞¥', 'Áô∏': 'Ê∞¥',
                // Âú∞ÊîØ‰∫îË°å
                'Â≠ê': 'Ê∞¥', '‰∏ë': 'Âúü', 'ÂØÖ': 'Êú®', 'ÂçØ': 'Êú®', 'Ëæ∞': 'Âúü', 'Â∑≥': 'ÁÅ´',
                'Âçà': 'ÁÅ´', 'Êú™': 'Âúü', 'Áî≥': 'Èáë', 'ÈÖâ': 'Èáë', 'Êàå': 'Âúü', '‰∫•': 'Ê∞¥'
            };

            const wuxingCount = { 'Êú®': 0, 'ÁÅ´': 0, 'Âúü': 0, 'Èáë': 0, 'Ê∞¥': 0 };
            const pillars = [baziResult.year, baziResult.month, baziResult.day, baziResult.hour];
            
            pillars.forEach(pillar => {
                if (pillar && pillar.length >= 2) {
                    // Ë®àÁÆóÂ§©Âπ≤‰∫îË°å
                    const tiangan = pillar[0];
                    const tianganWuxing = wuxingMap[tiangan];
                    if (tianganWuxing) {
                        wuxingCount[tianganWuxing]++;
                    }
                    
                    // Ë®àÁÆóÂú∞ÊîØ‰∫îË°å
                    const dizhi = pillar[1];
                    const dizhiWuxing = wuxingMap[dizhi];
                    if (dizhiWuxing) {
                        wuxingCount[dizhiWuxing]++;
                    }
                }
            });

            // Ë®àÁÆóÈô∞ÈôΩÂπ≥Ë°°
            const yinyangMap = {
                'Áî≤': 'ÈôΩ', '‰πô': 'Èô∞', '‰∏ô': 'ÈôΩ', '‰∏Å': 'Èô∞', 'Êàä': 'ÈôΩ',
                'Â∑±': 'Èô∞', 'Â∫ö': 'ÈôΩ', 'Ëæõ': 'Èô∞', 'Â£¨': 'ÈôΩ', 'Áô∏': 'Èô∞'
            };

            let yangCount = 0, yinCount = 0;
            pillars.forEach(pillar => {
                if (pillar && pillar.length > 0) {
                    const tiangan = pillar[0];
                    if (yinyangMap[tiangan] === 'ÈôΩ') {
                        yangCount++;
                    } else {
                        yinCount++;
                    }
                }
            });

            analysisContent.innerHTML = `
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h3 class="analysis-title">‚öñÔ∏è Èô∞ÈôΩÂπ≥Ë°°</h3>
                        <div class="element-item">
                            <span class="element-label">ÈôΩÊÄßÂ§©Âπ≤Ôºö</span>
                            <span class="element-value">${yangCount} ÂÄã (${Math.round(yangCount/4*100)}%)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${yangCount/4*100}%"></div>
                        </div>
                        <div class="element-item">
                            <span class="element-label">Èô∞ÊÄßÂ§©Âπ≤Ôºö</span>
                            <span class="element-value">${yinCount} ÂÄã (${Math.round(yinCount/4*100)}%)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${yinCount/4*100}%"></div>
                        </div>
                    </div>
                    
                    <div class="analysis-card">
                        <h3 class="analysis-title">üåü ‰∫îË°åÂàÜÂ∏É</h3>
                        ${Object.entries(wuxingCount).map(([element, count]) => `
                            <div class="element-item">
                                <span class="element-label">${element}Ôºö</span>
                                <span class="element-value">${count} ÂÄã (${Math.round(count/8*100)}%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${count/8*100}%"></div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="analysis-card">
                        <h3 class="analysis-title">üéØ ÂëΩÊ†ºÁâπË≥™</h3>
                        <div class="element-item">
                            <span class="element-label">Êó•‰∏ªÔºö</span>
                            <span class="element-value">${baziResult.dayMaster} (${wuxingMap[baziResult.dayMaster]})</span>
                        </div>
                        <div class="element-item">
                            <span class="element-label">Âπ¥Êü±Ôºö</span>
                            <span class="element-value">${baziResult.year}</span>
                        </div>
                        <div class="element-item">
                            <span class="element-label">ÊúàÊü±Ôºö</span>
                            <span class="element-value">${baziResult.month}</span>
                        </div>
                        <div class="element-item">
                            <span class="element-label">Êó•Êü±Ôºö</span>
                            <span class="element-value">${baziResult.day}</span>
                        </div>
                        <div class="element-item">
                            <span class="element-label">ÊôÇÊü±Ôºö</span>
                            <span class="element-value">${baziResult.hour}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // ËºîÂä©ÂáΩÊï∏
        function getFieldName(field) {
            const names = {
                'year': 'Âá∫ÁîüÂπ¥',
                'month': 'Âá∫ÁîüÊúà',
                'day': 'Âá∫ÁîüÊó•',
                'hour': 'Âá∫ÁîüÊôÇ'
            };
            return names[field] || field;
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>

