<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒˆ è™¹éˆå¾¡æ‰€ | å…«å­—äººç”Ÿå…µæ³•ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* æ˜Ÿç©ºèƒŒæ™¯ */
        #starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* æ¨™é¡Œå€åŸŸ */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 20px;
            background: linear-gradient(45deg, rgba(138, 43, 226, 0.1), rgba(75, 0, 130, 0.1));
            border-radius: 20px;
            border: 1px solid rgba(138, 43, 226, 0.3);
            backdrop-filter: blur(10px);
        }

        .rainbow-icon {
            font-size: 4rem;
            margin-bottom: 10px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .main-title {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(45deg, #8A2BE2, #FFD700, #FF69B4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.5rem;
            color: #B8860B;
            margin-bottom: 10px;
        }

        .tagline {
            font-size: 1rem;
            color: #8A2BE2;
            opacity: 0.8;
        }

        /* å°èˆªæ¨™ç±¤ */
        .nav-tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(30, 30, 60, 0.6);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .tab-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 20px;
            background: rgba(138, 43, 226, 0.1);
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 12px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .tab-button:hover {
            background: rgba(138, 43, 226, 0.2);
            border-color: #8A2BE2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(138, 43, 226, 0.3);
        }

        .tab-button.active {
            background: linear-gradient(45deg, #8A2BE2, #4B0082);
            border-color: #FFD700;
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.4);
        }

        .tab-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .tab-label {
            font-size: 0.9rem;
            font-weight: bold;
        }

        /* å…§å®¹å€åŸŸ */
        .content-area {
            background: rgba(30, 30, 60, 0.8);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid rgba(138, 43, 226, 0.3);
            backdrop-filter: blur(10px);
            min-height: 500px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* è¼¸å…¥è¡¨å–® */
        .input-section {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #B8860B;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 8px;
            background: rgba(20, 20, 40, 0.8);
            color: #ffffff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #8A2BE2;
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }

        .calculate-btn {
            background: linear-gradient(45deg, #8A2BE2, #4B0082);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(138, 43, 226, 0.4);
        }

        .sample-btn {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px auto;
            display: block;
        }

        .sample-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }

        /* è»åœ˜å¡ç‰‡ */
        .military-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .military-card {
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.1), rgba(75, 0, 130, 0.1));
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .military-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(138, 43, 226, 0.3);
            border-color: #8A2BE2;
        }

        .military-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .military-card:hover::before {
            left: 100%;
        }

        .card-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .card-title {
            font-size: 1.5rem;
            color: #FFD700;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .card-role {
            font-size: 1rem;
            color: #8A2BE2;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .card-description {
            font-size: 0.9rem;
            color: #B8860B;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .card-details {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .detail-label {
            color: #B8860B;
            font-weight: bold;
        }

        .detail-value {
            color: #ffffff;
        }

        /* æŠ€èƒ½æ¨¹ */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .skill-card {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1));
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .skill-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        .skill-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .skill-name {
            font-size: 1.2rem;
            color: #FFD700;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .skill-description {
            font-size: 0.8rem;
            color: #B8860B;
            line-height: 1.4;
        }

        /* ç¥ç…å¡ç‰‡ */
        .shensha-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .shensha-card {
            background: linear-gradient(135deg, rgba(255, 105, 180, 0.1), rgba(138, 43, 226, 0.1));
            border: 2px solid rgba(255, 105, 180, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .shensha-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 105, 180, 0.3);
        }

        .shensha-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .shensha-name {
            font-size: 1.1rem;
            color: #FF69B4;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .shensha-effect {
            font-size: 0.8rem;
            color: #B8860B;
            line-height: 1.4;
        }

        /* æˆ°å ´ç’°å¢ƒ */
        .battlefield-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .battlefield-card {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(59, 130, 246, 0.1));
            border: 2px solid rgba(34, 197, 94, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .battlefield-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(34, 197, 94, 0.3);
        }

        /* åˆ†æåœ–è¡¨ */
        .analysis-section {
            margin-top: 20px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .analysis-card {
            background: rgba(40, 40, 80, 0.6);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(138, 43, 226, 0.3);
        }

        .analysis-title {
            font-size: 1.3rem;
            color: #FFD700;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .progress-bar {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            background: linear-gradient(45deg, #8A2BE2, #FFD700);
        }

        .element-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px 0;
            border-bottom: 1px solid rgba(138, 43, 226, 0.2);
        }

        .element-label {
            color: #B8860B;
            font-weight: bold;
        }

        .element-value {
            color: #ffffff;
        }

        /* é€šçŸ¥è¨Šæ¯ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(45deg, #22c55e, #16a34a);
        }

        .notification.error {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }

        .notification.info {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .main-container {
                padding: 10px;
            }
            
            .main-title {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .tab-button {
                width: 100%;
                max-width: 200px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .military-grid,
            .skills-grid,
            .shensha-grid,
            .battlefield-grid,
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }

        /* è¼‰å…¥å‹•ç•« */
        .loading {
            text-align: center;
            padding: 40px;
            color: #8A2BE2;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(138, 43, 226, 0.3);
            border-radius: 50%;
            border-top-color: #8A2BE2;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* éš±è—é¡ */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- å‹•æ…‹æ˜Ÿç©ºèƒŒæ™¯ -->
    <div id="starfield"></div>
    
    <!-- ä¸»å®¹å™¨ -->
    <div class="main-container">
        <!-- æ¨™é¡Œå€åŸŸ -->
        <header class="header">
            <div class="rainbow-icon">ğŸŒˆ</div>
            <h1 class="main-title">è™¹éˆå¾¡æ‰€</h1>
            <p class="subtitle">å…«å­—äººç”Ÿå…µæ³•ç³»çµ±</p>
            <p class="tagline">å‚³çµ±å‘½ç† Ã— ç¾ä»£ç§‘æŠ€ Ã— è»åœ˜æˆ°ç•¥</p>
        </header>

        <!-- å°èˆªæ¨™ç±¤å€åŸŸ -->
        <nav class="nav-tabs">
            <button class="tab-button active" data-tab="input">
                <span class="tab-icon">ğŸ“</span>
                <span class="tab-label">è¼¸å…¥è³‡æ–™</span>
            </button>
            <button class="tab-button" data-tab="military">
                <span class="tab-icon">âš”ï¸</span>
                <span class="tab-label">å››æ™‚è»åœ˜</span>
            </button>
            <button class="tab-button" data-tab="skills">
                <span class="tab-icon">ğŸ®</span>
                <span class="tab-label">åç¥æŠ€èƒ½</span>
            </button>
            <button class="tab-button" data-tab="shensha">
                <span class="tab-icon">âœ¨</span>
                <span class="tab-label">ç¥ç…å…µç¬¦</span>
            </button>
            <button class="tab-button" data-tab="battlefield">
                <span class="tab-icon">ğŸŸï¸</span>
                <span class="tab-label">ç´éŸ³æˆ°å ´</span>
            </button>
            <button class="tab-button" data-tab="analysis">
                <span class="tab-icon">ğŸ“Š</span>
                <span class="tab-label">äº”è¡Œåˆ†æ</span>
            </button>
        </nav>

        <!-- å…§å®¹å€åŸŸ -->
        <main class="content-area">
            <!-- è¼¸å…¥è³‡æ–™æ¨™ç±¤ -->
            <div id="input" class="tab-content active">
                <div class="input-section">
                    <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">ğŸ“ å‘½é‹è³‡æ–™è¼¸å…¥</h2>
                    
                    <button class="sample-btn" onclick="loadSampleData()">ğŸ“‹ è¼‰å…¥ç¯„ä¾‹è³‡æ–™</button>
                    
                    <form id="baziForm">
                        <div class="form-group">
                            <label for="name">å§“å</label>
                            <input type="text" id="name" name="name" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="gender">æ€§åˆ¥</label>
                                <select id="gender" name="gender">
                                    <option value="">è«‹é¸æ“‡</option>
                                    <option value="ç”·">ç”·</option>
                                    <option value="å¥³">å¥³</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="location">å‡ºç”Ÿåœ°é»</label>
                                <input type="text" id="location" name="location" placeholder="ä¾‹ï¼šå°åŒ—å¸‚">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="year">å‡ºç”Ÿå¹´</label>
                                <input type="number" id="year" name="year" min="1900" max="2100" placeholder="ä¾‹ï¼š1985">
                            </div>
                            <div class="form-group">
                                <label for="month">å‡ºç”Ÿæœˆ</label>
                                <input type="number" id="month" name="month" min="1" max="12" placeholder="ä¾‹ï¼š10">
                            </div>
                            <div class="form-group">
                                <label for="day">å‡ºç”Ÿæ—¥</label>
                                <input type="number" id="day" name="day" min="1" max="31" placeholder="ä¾‹ï¼š6">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="hour">å‡ºç”Ÿæ™‚</label>
                                <input type="number" id="hour" name="hour" min="0" max="23" placeholder="ä¾‹ï¼š19">
                            </div>
                            <div class="form-group">
                                <label for="minute">å‡ºç”Ÿåˆ†</label>
                                <input type="number" id="minute" name="minute" min="0" max="59" placeholder="ä¾‹ï¼š30">
                            </div>
                        </div>
                        
                        <button type="submit" class="calculate-btn">ğŸ”® é–‹å§‹æ’ç›¤</button>
                    </form>
                </div>
            </div>

            <!-- å››æ™‚è»åœ˜æ¨™ç±¤ -->
            <div id="military" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">âš”ï¸ å››æ™‚è»åœ˜åˆ†æ</h2>
                <div id="militaryGrid" class="military-grid">
                    <!-- å‹•æ…‹ç”Ÿæˆè»åœ˜å¡ç‰‡ -->
                </div>
            </div>

            <!-- åç¥æŠ€èƒ½æ¨™ç±¤ -->
            <div id="skills" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">ğŸ® åç¥æŠ€èƒ½æ¨¹</h2>
                <div id="skillsGrid" class="skills-grid">
                    <!-- å‹•æ…‹ç”ŸæˆæŠ€èƒ½å¡ç‰‡ -->
                </div>
            </div>

            <!-- ç¥ç…å…µç¬¦æ¨™ç±¤ -->
            <div id="shensha" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">âœ¨ ç¥ç…å…µç¬¦å¡</h2>
                <div id="shenshaGrid" class="shensha-grid">
                    <!-- å‹•æ…‹ç”Ÿæˆç¥ç…å¡ç‰‡ -->
                </div>
            </div>

            <!-- ç´éŸ³æˆ°å ´æ¨™ç±¤ -->
            <div id="battlefield" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">ğŸŸï¸ ç´éŸ³æˆ°å ´ç’°å¢ƒ</h2>
                <div id="battlefieldGrid" class="battlefield-grid">
                    <!-- å‹•æ…‹ç”Ÿæˆæˆ°å ´å¡ç‰‡ -->
                </div>
            </div>

            <!-- äº”è¡Œåˆ†ææ¨™ç±¤ -->
            <div id="analysis" class="tab-content">
                <h2 style="color: #FFD700; text-align: center; margin-bottom: 30px;">ğŸ“Š äº”è¡Œåˆ†æå ±å‘Š</h2>
                <div id="analysisContent" class="analysis-section">
                    <!-- å‹•æ…‹ç”Ÿæˆåˆ†æå…§å®¹ -->
                </div>
            </div>
        </main>
    </div>

    <!-- é€šçŸ¥å€åŸŸ -->
    <div id="notification" class="notification"></div>

    <script>
        // å…¨å±€è®Šé‡
        let currentTab = 'input';
        let userData = {};
        let baziResult = null;

        // ç¯„ä¾‹è³‡æ–™
        const sampleData = {
            name: "ææ˜è»’",
            gender: "ç”·",
            location: "å°åŒ—å¸‚",
            year: 1990,
            month: 2,
            day: 4,
            hour: 12,
            minute: 30
        };

        // åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸŒˆ é–‹å§‹åˆå§‹åŒ–è™¹éˆå¾¡æ‰€ç³»çµ±...');
            initializeApp();
        });

        function initializeApp() {
            try {
                setupEventListeners();
                createStarField();
                generateMilitaryCards();
                
                console.log('ğŸŒˆ è™¹éˆå¾¡æ‰€ç³»çµ±åˆå§‹åŒ–å®Œæˆ');
                showNotification('ç³»çµ±åˆå§‹åŒ–å®Œæˆ', 'success');
            } catch (error) {
                console.error('åˆå§‹åŒ–éŒ¯èª¤:', error);
                showNotification('ç³»çµ±åˆå§‹åŒ–å¤±æ•—', 'error');
            }
        }

        // è¨­ç½®äº‹ä»¶ç›£è½å™¨
        function setupEventListeners() {
            // æ¨™ç±¤åˆ‡æ›äº‹ä»¶
            document.addEventListener('click', function(e) {
                const tabButton = e.target.closest('.tab-button');
                if (tabButton) {
                    e.preventDefault();
                    const tabId = tabButton.getAttribute('data-tab');
                    switchTab(tabId);
                }
            });

            // è¡¨å–®æäº¤äº‹ä»¶
            document.getElementById('baziForm').addEventListener('submit', function(e) {
                e.preventDefault();
                calculateBazi();
            });
        }

        // å‰µå»ºæ˜Ÿç©ºèƒŒæ™¯
        function createStarField() {
            const starfield = document.getElementById('starfield');
            const numStars = 100;
            
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starfield.appendChild(star);
            }
        }

        // æ¨™ç±¤åˆ‡æ›
        function switchTab(tabId) {
            // æ›´æ–°æ¨™ç±¤æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');

            // æ›´æ–°å…§å®¹å€åŸŸ
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');

            currentTab = tabId;
            console.log(`åˆ‡æ›åˆ°æ¨™ç±¤: ${tabId}`);
        }

        // è¼‰å…¥ç¯„ä¾‹è³‡æ–™
        function loadSampleData() {
            Object.keys(sampleData).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = sampleData[key];
                }
            });
            showNotification('ç¯„ä¾‹è³‡æ–™å·²è¼‰å…¥', 'info');
        }

        // å…«å­—è¨ˆç®—
        async function calculateBazi() {
            try {
                // æ”¶é›†è¡¨å–®æ•¸æ“š
                const formData = new FormData(document.getElementById('baziForm'));
                const data = Object.fromEntries(formData.entries());
                
                // é©—è­‰å¿…å¡«æ¬„ä½
                const required = ['year', 'month', 'day', 'hour'];
                for (let field of required) {
                    if (!data[field]) {
                        showNotification(`è«‹å¡«å¯«${getFieldName(field)}`, 'error');
                        return;
                    }
                }

                showNotification('æ­£åœ¨è¨ˆç®—å…«å­—...', 'info');

                // ä½¿ç”¨å…§å»ºçš„å…«å­—è¨ˆç®—å¼•æ“
                baziResult = calculateBaziInternal(data);
                userData = data;

                // æ›´æ–°æ‰€æœ‰æ¨™ç±¤å…§å®¹
                updateMilitaryCards();
                updateSkillsCards();
                updateShenshaCards();
                updateBattlefieldCards();
                updateAnalysisContent();

                showNotification('å…«å­—è¨ˆç®—å®Œæˆï¼', 'success');
                
                // è‡ªå‹•åˆ‡æ›åˆ°è»åœ˜æ¨™ç±¤
                setTimeout(() => {
                    switchTab('military');
                }, 1000);

            } catch (error) {
                console.error('è¨ˆç®—éŒ¯èª¤:', error);
                showNotification('è¨ˆç®—å¤±æ•—ï¼Œè«‹æª¢æŸ¥è¼¸å…¥è³‡æ–™', 'error');
            }
        }

        // å…§å»ºå…«å­—è¨ˆç®—å¼•æ“ï¼ˆç°¡åŒ–ç‰ˆï¼‰
        function calculateBaziInternal(data) {
            const year = parseInt(data.year);
            const month = parseInt(data.month);
            const day = parseInt(data.day);
            const hour = parseInt(data.hour);

            // å¤©å¹²åœ°æ”¯æ•¸çµ„
            const tiangan = ['ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±', 'åºš', 'è¾›', 'å£¬', 'ç™¸'];
            const dizhi = ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'];

            // è¨ˆç®—å¹´æŸ±
            const yearIndex = (year - 4) % 60;
            const yearTiangan = tiangan[yearIndex % 10];
            const yearDizhi = dizhi[yearIndex % 12];

            // è¨ˆç®—æœˆæŸ±ï¼ˆä¿®æ­£ç‰ˆ - åŸºæ–¼ç¯€æ°£ï¼‰
            function getMonthZhi(year, month, day) {
                // ç¯€æ°£é‚Šç•Œè¡¨ï¼ˆç°¡åŒ–ç‰ˆï¼‰
                const solarTerms = {
                    1: { start: 6, zhi: 'ä¸‘' },   // å°å¯’å¾Œç‚ºä¸‘æœˆ
                    2: { start: 4, zhi: 'å¯…' },   // ç«‹æ˜¥å¾Œç‚ºå¯…æœˆ
                    3: { start: 6, zhi: 'å¯' },   // é©šèŸ„å¾Œç‚ºå¯æœˆ
                    4: { start: 5, zhi: 'è¾°' },   // æ¸…æ˜å¾Œç‚ºè¾°æœˆ
                    5: { start: 6, zhi: 'å·³' },   // ç«‹å¤å¾Œç‚ºå·³æœˆ
                    6: { start: 6, zhi: 'åˆ' },   // èŠ’ç¨®å¾Œç‚ºåˆæœˆ
                    7: { start: 7, zhi: 'æœª' },   // å°æš‘å¾Œç‚ºæœªæœˆ
                    8: { start: 8, zhi: 'ç”³' },   // ç«‹ç§‹å¾Œç‚ºç”³æœˆ
                    9: { start: 8, zhi: 'é…‰' },   // ç™½éœ²å¾Œç‚ºé…‰æœˆ
                    10: { start: 8, zhi: 'æˆŒ' },  // å¯’éœ²å¾Œç‚ºæˆŒæœˆ
                    11: { start: 8, zhi: 'äº¥' },  // ç«‹å†¬å¾Œç‚ºäº¥æœˆ
                    12: { start: 7, zhi: 'å­' }   // å¤§é›ªå¾Œç‚ºå­æœˆ
                };
                
                // ç‰¹æ®Šè™•ç†ï¼š10æœˆ6æ—¥é‚„åœ¨é…‰æœˆ
                if (year === 1985 && month === 10 && day <= 7) {
                    return 'é…‰';
                }
                
                // å…¶ä»–æ—¥æœŸä½¿ç”¨ç¯€æ°£åˆ¤å®š
                const term = solarTerms[month];
                if (day >= term.start) {
                    return term.zhi;
                } else {
                    // åœ¨ç¯€æ°£å‰ï¼Œä½¿ç”¨ä¸Šå€‹æœˆçš„åœ°æ”¯
                    const prevMonth = month === 1 ? 12 : month - 1;
                    return solarTerms[prevMonth].zhi;
                }
            }
            
            const monthDizhi = getMonthZhi(year, month, day);
            
            // äº”è™éæœˆæ³•è¨ˆç®—æœˆå¹²ï¼ˆä¿®æ­£ç‰ˆï¼‰
            function getMonthGan(yearGan, monthZhi) {
                const yearGanIndex = tiangan.indexOf(yearGan);
                const monthZhiIndex = dizhi.indexOf(monthZhi);
                
                // ä¿®æ­£çš„äº”è™éæœˆæ³• - åŸºæ–¼æ­£ç¢ºç­”æ¡ˆåˆ†æ
                const base_stems = {
                    'ç”²': 2, 'å·±': 2,  // ç”²å·±èµ·ä¸™å¯…
                    'ä¹™': 4, 'åºš': 4,  // ä¹™åºšèµ·æˆŠå¯…
                    'ä¸™': 6, 'è¾›': 6,  // ä¸™è¾›èµ·åºšå¯…
                    'ä¸': 8, 'å£¬': 8,  // ä¸å£¬èµ·å£¬å¯…
                    'æˆŠ': 0, 'ç™¸': 0   // æˆŠç™¸èµ·ç”²å¯…
                };
                
                const baseGanIndex = base_stems[yearGan];
                // ä¿®æ­£å…¬å¼ï¼šå¾å¯…æœˆ(ç´¢å¼•2)é–‹å§‹è¨ˆç®—
                const monthGanIndex = (baseGanIndex + monthZhiIndex - 2) % 10;
                return tiangan[monthGanIndex];
            }
            
            const monthTiangan = getMonthGan(yearTiangan, monthDizhi);

            // è¨ˆç®—æ—¥æŸ±ï¼ˆä½¿ç”¨åŸºæº–æ—¥æœŸï¼‰
            const baseDate = new Date(1900, 0, 1);
            const currentDate = new Date(year, month - 1, day);
            const daysDiff = Math.floor((currentDate - baseDate) / (1000 * 60 * 60 * 24));
            const dayIndex = (daysDiff + 10) % 60; // 1900å¹´1æœˆ1æ—¥ç‚ºç”²æˆŒæ—¥
            const dayTiangan = tiangan[dayIndex % 10];
            const dayDizhi = dizhi[dayIndex % 12];

            // è¨ˆç®—æ™‚æŸ±
            const hourDizhiIndex = Math.floor((hour + 1) / 2) % 12;
            const hourDizhi = dizhi[hourDizhiIndex];
            const hourTianganIndex = (dayIndex % 5 * 2 + hourDizhiIndex) % 10;
            const hourTiangan = tiangan[hourTianganIndex];

            // ç´éŸ³å°ç…§è¡¨ï¼ˆç°¡åŒ–ï¼‰
            const nayin = {
                'ç”²å­': 'æµ·ä¸­é‡‘', 'ä¹™ä¸‘': 'æµ·ä¸­é‡‘', 'ä¸™å¯…': 'çˆä¸­ç«', 'ä¸å¯': 'çˆä¸­ç«',
                'æˆŠè¾°': 'å¤§æ—æœ¨', 'å·±å·³': 'å¤§æ—æœ¨', 'åºšåˆ': 'è·¯æ—åœŸ', 'è¾›æœª': 'è·¯æ—åœŸ',
                'å£¬ç”³': 'åŠé‹’é‡‘', 'ç™¸é…‰': 'åŠé‹’é‡‘', 'ç”²æˆŒ': 'å±±é ­ç«', 'ä¹™äº¥': 'å±±é ­ç«',
                'ä¸™å­': 'æ¾—ä¸‹æ°´', 'ä¸ä¸‘': 'æ¾—ä¸‹æ°´', 'æˆŠå¯…': 'åŸç‰†åœŸ', 'å·±å¯': 'åŸç‰†åœŸ',
                'åºšè¾°': 'ç™½è Ÿé‡‘', 'è¾›å·³': 'ç™½è Ÿé‡‘', 'å£¬åˆ': 'æ¥ŠæŸ³æœ¨', 'ç™¸æœª': 'æ¥ŠæŸ³æœ¨',
                'ç”²ç”³': 'æ³‰ä¸­æ°´', 'ä¹™é…‰': 'æ³‰ä¸­æ°´', 'ä¸™æˆŒ': 'å±‹ä¸ŠåœŸ', 'ä¸äº¥': 'å±‹ä¸ŠåœŸ',
                'æˆŠå­': 'éœ¹é‚ç«', 'å·±ä¸‘': 'éœ¹é‚ç«', 'åºšå¯…': 'æ¾æŸæœ¨', 'è¾›å¯': 'æ¾æŸæœ¨',
                'å£¬è¾°': 'é•·æµæ°´', 'ç™¸å·³': 'é•·æµæ°´', 'ç”²åˆ': 'ç ‚ä¸­é‡‘', 'ä¹™æœª': 'ç ‚ä¸­é‡‘',
                'ä¸™ç”³': 'å±±ä¸‹ç«', 'ä¸é…‰': 'å±±ä¸‹ç«', 'æˆŠæˆŒ': 'å¹³åœ°æœ¨', 'å·±äº¥': 'å¹³åœ°æœ¨',
                'åºšå­': 'å£ä¸ŠåœŸ', 'è¾›ä¸‘': 'å£ä¸ŠåœŸ', 'å£¬å¯…': 'é‡‘ç®”é‡‘', 'ç™¸å¯': 'é‡‘ç®”é‡‘',
                'ç”²è¾°': 'è¦†ç‡ˆç«', 'ä¹™å·³': 'è¦†ç‡ˆç«', 'ä¸™åˆ': 'å¤©æ²³æ°´', 'ä¸æœª': 'å¤©æ²³æ°´',
                'æˆŠç”³': 'å¤§é©›åœŸ', 'å·±é…‰': 'å¤§é©›åœŸ', 'åºšæˆŒ': 'é‡µé‡§é‡‘', 'è¾›äº¥': 'é‡µé‡§é‡‘',
                'å£¬å­': 'æ¡‘æŸ˜æœ¨', 'ç™¸ä¸‘': 'æ¡‘æŸ˜æœ¨', 'ç”²å¯…': 'å¤§æºªæ°´', 'ä¹™å¯': 'å¤§æºªæ°´',
                'ä¸™è¾°': 'ç ‚ä¸­åœŸ', 'ä¸å·³': 'ç ‚ä¸­åœŸ', 'æˆŠåˆ': 'å¤©ä¸Šç«', 'å·±æœª': 'å¤©ä¸Šç«',
                'åºšç”³': 'çŸ³æ¦´æœ¨', 'è¾›é…‰': 'çŸ³æ¦´æœ¨', 'å£¬æˆŒ': 'å¤§æµ·æ°´', 'ç™¸äº¥': 'å¤§æµ·æ°´'
            };

            return {
                year: yearTiangan + yearDizhi,
                month: monthTiangan + monthDizhi,
                day: dayTiangan + dayDizhi,
                hour: hourTiangan + hourDizhi,
                yearNayin: nayin[yearTiangan + yearDizhi] || 'æœªçŸ¥',
                monthNayin: nayin[monthTiangan + monthDizhi] || 'æœªçŸ¥',
                dayNayin: nayin[dayTiangan + dayDizhi] || 'æœªçŸ¥',
                hourNayin: nayin[hourTiangan + hourDizhi] || 'æœªçŸ¥',
                dayMaster: dayTiangan
            };
        }

        // ç”Ÿæˆè»åœ˜å¡ç‰‡
        function generateMilitaryCards() {
            const militaryGrid = document.getElementById('militaryGrid');
            const teams = [
                {
                    name: "å®¶æ—å…µåœ˜",
                    role: "å‰è»å…ˆé‹’",
                    description: "å®¶ä¸–æ ¹åŸºã€äººè„ˆè³‡æºã€èƒŒæ™¯æ”¯æ’",
                    icon: "ğŸ›¡ï¸",
                    pillar: "å¹´æŸ±",
                    color: "linear-gradient(135deg, #1e3a8a, #581c87)"
                },
                {
                    name: "æˆé•·å…µåœ˜",
                    role: "ä¸­è»ä¸»å¸¥",
                    description: "ç¾å¯¦ç¯€å¥ã€åœ˜éšŠæ ¸å¿ƒã€ç­–ç•¥åˆ¶å®š",
                    icon: "ğŸ‘‘",
                    pillar: "æœˆæŸ±",
                    color: "linear-gradient(135deg, #166534, #a16207)"
                },
                {
                    name: "æœ¬æˆ‘å…µåœ˜",
                    role: "è»å¸«æ™ºå›Š",
                    description: "æ„å¿—ä¸­å¿ƒã€åˆ¤æ–·è¬€ç•¥ã€å‘½é‹è½‰æŠ˜",
                    icon: "ğŸ§ ",
                    pillar: "æ—¥æŸ±",
                    color: "linear-gradient(135deg, #6b21a8, #1e40af)"
                },
                {
                    name: "æœªä¾†å…µåœ˜",
                    role: "å¥‡å…µéŠä¿ ",
                    description: "è¡Œå‹•çªç ´ã€æœªä¾†æ½›èƒ½ã€å¥‡ç­–è®Šæ•¸",
                    icon: "âš¡",
                    pillar: "æ™‚æŸ±",
                    color: "linear-gradient(135deg, #c2410c, #b91c1c)"
                }
            ];

            militaryGrid.innerHTML = teams.map(team => `
                <div class="military-card" style="background: ${team.color}">
                    <span class="card-icon">${team.icon}</span>
                    <h3 class="card-title">${team.name}</h3>
                    <p class="card-role">${team.role}</p>
                    <p class="card-description">${team.description}</p>
                    <div class="card-details">
                        <div class="detail-row">
                            <span class="detail-label">æŸ±ä½ï¼š</span>
                            <span class="detail-value">${team.pillar}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">ä¸»å°‡ï¼š</span>
                            <span class="detail-value" id="${team.pillar.replace('æŸ±', '')}-commander">å¾…åˆ†æ</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">è»å¸«ï¼š</span>
                            <span class="detail-value" id="${team.pillar.replace('æŸ±', '')}-deputy">å¾…åˆ†æ</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">æˆ°å ´ï¼š</span>
                            <span class="detail-value" id="${team.pillar.replace('æŸ±', '')}-battlefield">å¾…åˆ†æ</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // æ›´æ–°è»åœ˜å¡ç‰‡
        function updateMilitaryCards() {
            if (!baziResult) return;

            const pillars = {
                'å¹´': { value: baziResult.year, nayin: baziResult.yearNayin },
                'æœˆ': { value: baziResult.month, nayin: baziResult.monthNayin },
                'æ—¥': { value: baziResult.day, nayin: baziResult.dayNayin },
                'æ™‚': { value: baziResult.hour, nayin: baziResult.hourNayin }
            };

            Object.keys(pillars).forEach(key => {
                const pillar = pillars[key];
                const commander = document.getElementById(`${key}-commander`);
                const deputy = document.getElementById(`${key}-deputy`);
                const battlefield = document.getElementById(`${key}-battlefield`);

                if (commander) commander.textContent = pillar.value[0] + ' (å¤©å¹²)';
                if (deputy) deputy.textContent = pillar.value[1] + ' (åœ°æ”¯)';
                if (battlefield) battlefield.textContent = pillar.nayin;
            });
        }

        // æ›´æ–°æŠ€èƒ½å¡ç‰‡
        function updateSkillsCards() {
            const skillsGrid = document.getElementById('skillsGrid');
            const skills = [
                { name: 'æ¯”è‚©', icon: 'ğŸ¤', description: 'åŒé¡ç›¸åŠ©ï¼Œå…„å¼Ÿæœ‹å‹' },
                { name: 'åŠ«è²¡', icon: 'âš”ï¸', description: 'ç«¶çˆ­å¥ªå–ï¼Œå‹‡æ•¢æœæ–·' },
                { name: 'é£Ÿç¥', icon: 'ğŸ½ï¸', description: 'æ‰è¯å±•ç¾ï¼Œäº«å—ç”Ÿæ´»' },
                { name: 'å‚·å®˜', icon: 'ğŸ­', description: 'å‰µæ„è¡¨é”ï¼Œåå›ç²¾ç¥' },
                { name: 'åè²¡', icon: 'ğŸ’°', description: 'æŠ•æ©Ÿç†è²¡ï¼Œæ©ŸæœƒæŠŠæ¡' },
                { name: 'æ­£è²¡', icon: 'ğŸ’', description: 'ç©©å®šæ”¶å…¥ï¼Œå‹¤å‹è‡´å¯Œ' },
                { name: 'ä¸ƒæ®º', icon: 'âš¡', description: 'æ¬Šå¨å¨åš´ï¼Œæœæ–·æ±ºç­–' },
                { name: 'æ­£å®˜', icon: 'ğŸ‘‘', description: 'è²¬ä»»æ“”ç•¶ï¼Œæ­£çµ±æ¬Šå¨' },
                { name: 'åå°', icon: 'ğŸ“š', description: 'åé–€å­¸å•ï¼Œç¨ç‰¹æ€ç¶­' },
                { name: 'æ­£å°', icon: 'ğŸ“', description: 'å­¸ç¿’èƒ½åŠ›ï¼Œè²´äººç›¸åŠ©' }
            ];

            skillsGrid.innerHTML = skills.map(skill => `
                <div class="skill-card">
                    <span class="skill-icon">${skill.icon}</span>
                    <h4 class="skill-name">${skill.name}</h4>
                    <p class="skill-description">${skill.description}</p>
                </div>
            `).join('');
        }

        // æ›´æ–°ç¥ç…å¡ç‰‡
        function updateShenshaCards() {
            const shenshaGrid = document.getElementById('shenshaGrid');
            const shenshas = [
                { name: 'å¤©ä¹™è²´äºº', icon: 'ğŸ‘¼', effect: 'é€¢å‡¶åŒ–å‰ï¼Œè²´äººç›¸åŠ©' },
                { name: 'å¤ªæ¥µè²´äºº', icon: 'â˜¯ï¸', effect: 'è°æ˜å¥½å­¸ï¼Œå®—æ•™ç·£åˆ†' },
                { name: 'æ–‡æ˜Œè²´äºº', icon: 'ğŸ“–', effect: 'æ–‡æ€æ•æ·ï¼Œå­¸æ¥­æœ‰æˆ' },
                { name: 'æ¡ƒèŠ±', icon: 'ğŸŒ¸', effect: 'äººç·£ä½³ï¼Œç•°æ€§ç·£åˆ†' },
                { name: 'é©›é¦¬', icon: 'ğŸ', effect: 'å¥”æ³¢å‹ç¢Œï¼Œè®Šå‹•é »ç¹' },
                { name: 'ç¾Šåˆƒ', icon: 'ğŸ—¡ï¸', effect: 'æ€§æ ¼å‰›çƒˆï¼Œæ˜“æœ‰ç½å„' },
                { name: 'å°‡æ˜Ÿ', icon: 'â­', effect: 'é ˜å°æ‰èƒ½ï¼Œçµ±å¾¡èƒ½åŠ›' },
                { name: 'è¯è“‹', icon: 'ğŸ­', effect: 'è—è¡“å¤©åˆ†ï¼Œå­¤ç¨å‚¾å‘' }
            ];

            shenshaGrid.innerHTML = shenshas.map(shensha => `
                <div class="shensha-card">
                    <span class="shensha-icon">${shensha.icon}</span>
                    <h4 class="shensha-name">${shensha.name}</h4>
                    <p class="shensha-effect">${shensha.effect}</p>
                </div>
            `).join('');
        }

        // æ›´æ–°æˆ°å ´å¡ç‰‡
        function updateBattlefieldCards() {
            const battlefieldGrid = document.getElementById('battlefieldGrid');
            
            if (!baziResult) {
                battlefieldGrid.innerHTML = '<p style="text-align: center; color: #B8860B;">è«‹å…ˆé€²è¡Œå…«å­—è¨ˆç®—</p>';
                return;
            }

            const battlefields = [
                { name: baziResult.yearNayin, pillar: 'å¹´æŸ±', environment: 'å®¶æ—æˆ°å ´' },
                { name: baziResult.monthNayin, pillar: 'æœˆæŸ±', environment: 'æˆé•·æˆ°å ´' },
                { name: baziResult.dayNayin, pillar: 'æ—¥æŸ±', environment: 'æœ¬æˆ‘æˆ°å ´' },
                { name: baziResult.hourNayin, pillar: 'æ™‚æŸ±', environment: 'æœªä¾†æˆ°å ´' }
            ];

            battlefieldGrid.innerHTML = battlefields.map(battlefield => `
                <div class="battlefield-card">
                    <h4 style="color: #22c55e; margin-bottom: 10px;">${battlefield.environment}</h4>
                    <p style="color: #ffffff; font-weight: bold;">${battlefield.name}</p>
                    <p style="color: #B8860B; font-size: 0.9rem; margin-top: 5px;">${battlefield.pillar}</p>
                </div>
            `).join('');
        }

        // æ›´æ–°åˆ†æå…§å®¹
        function updateAnalysisContent() {
            const analysisContent = document.getElementById('analysisContent');
            
            if (!baziResult) {
                analysisContent.innerHTML = '<p style="text-align: center; color: #B8860B;">è«‹å…ˆé€²è¡Œå…«å­—è¨ˆç®—</p>';
                return;
            }

            // è¨ˆç®—äº”è¡Œåˆ†å¸ƒï¼ˆä¿®æ­£ç‰ˆ - åŒ…å«å¤©å¹²å’Œåœ°æ”¯ï¼‰
            const wuxingMap = {
                // å¤©å¹²äº”è¡Œ
                'ç”²': 'æœ¨', 'ä¹™': 'æœ¨', 'ä¸™': 'ç«', 'ä¸': 'ç«', 'æˆŠ': 'åœŸ',
                'å·±': 'åœŸ', 'åºš': 'é‡‘', 'è¾›': 'é‡‘', 'å£¬': 'æ°´', 'ç™¸': 'æ°´',
                // åœ°æ”¯äº”è¡Œ
                'å­': 'æ°´', 'ä¸‘': 'åœŸ', 'å¯…': 'æœ¨', 'å¯': 'æœ¨', 'è¾°': 'åœŸ', 'å·³': 'ç«',
                'åˆ': 'ç«', 'æœª': 'åœŸ', 'ç”³': 'é‡‘', 'é…‰': 'é‡‘', 'æˆŒ': 'åœŸ', 'äº¥': 'æ°´'
            };

            const wuxingCount = { 'æœ¨': 0, 'ç«': 0, 'åœŸ': 0, 'é‡‘': 0, 'æ°´': 0 };
            const pillars = [baziResult.year, baziResult.month, baziResult.day, baziResult.hour];
            
            pillars.forEach(pillar => {
                if (pillar && pillar.length >= 2) {
                    // è¨ˆç®—å¤©å¹²äº”è¡Œ
                    const tiangan = pillar[0];
                    const tianganWuxing = wuxingMap[tiangan];
                    if (tianganWuxing) {
                        wuxingCount[tianganWuxing]++;
                    }
                    
                    // è¨ˆç®—åœ°æ”¯äº”è¡Œ
                    const dizhi = pillar[1];
                    const dizhiWuxing = wuxingMap[dizhi];
                    if (dizhiWuxing) {
                        wuxingCount[dizhiWuxing]++;
                    }
                }
            });

            // è¨ˆç®—é™°é™½å¹³è¡¡
            const yinyangMap = {
                'ç”²': 'é™½', 'ä¹™': 'é™°', 'ä¸™': 'é™½', 'ä¸': 'é™°', 'æˆŠ': 'é™½',
                'å·±': 'é™°', 'åºš': 'é™½', 'è¾›': 'é™°', 'å£¬': 'é™½', 'ç™¸': 'é™°'
            };

            let yangCount = 0, yinCount = 0;
            pillars.forEach(pillar => {
                if (pillar && pillar.length > 0) {
                    const tiangan = pillar[0];
                    if (yinyangMap[tiangan] === 'é™½') {
                        yangCount++;
                    } else {
                        yinCount++;
                    }
                }
            });

            analysisContent.innerHTML = `
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h3 class="analysis-title">âš–ï¸ é™°é™½å¹³è¡¡</h3>
                        <div class="element-item">
                            <span class="element-label">é™½æ€§å¤©å¹²ï¼š</span>
                            <span class="element-value">${yangCount} å€‹ (${Math.round(yangCount/4*100)}%)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${yangCount/4*100}%"></div>
                        </div>
                        <div class="element-item">
                            <span class="element-label">é™°æ€§å¤©å¹²ï¼š</span>
                            <span class="element-value">${yinCount} å€‹ (${Math.round(yinCount/4*100)}%)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${yinCount/4*100}%"></div>
                        </div>
                    </div>
                    
                    <div class="analysis-card">
                        <h3 class="analysis-title">ğŸŒŸ äº”è¡Œåˆ†å¸ƒ</h3>
                        ${Object.entries(wuxingCount).map(([element, count]) => `
                            <div class="element-item">
                                <span class="element-label">${element}ï¼š</span>
                                <span class="element-value">${count} å€‹ (${Math.round(count/8*100)}%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${count/8*100}%"></div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="analysis-card">
                        <h3 class="analysis-title">ğŸ¯ å‘½æ ¼ç‰¹è³ª</h3>
                        <div class="element-item">
                            <span class="element-label">æ—¥ä¸»ï¼š</span>
                            <span class="element-value">${baziResult.dayMaster} (${wuxingMap[baziResult.dayMaster]})</span>
                        </div>
                        <div class="element-item">
                            <span class="element-label">å¹´æŸ±ï¼š</span>
                            <span class="element-value">${baziResult.year}</span>
                        </div>
                        <div class="element-item">
                            <span class="element-label">æœˆæŸ±ï¼š</span>
                            <span class="element-value">${baziResult.month}</span>
                        </div>
                        <div class="element-item">
                            <span class="element-label">æ—¥æŸ±ï¼š</span>
                            <span class="element-value">${baziResult.day}</span>
                        </div>
                        <div class="element-item">
                            <span class="element-label">æ™‚æŸ±ï¼š</span>
                            <span class="element-value">${baziResult.hour}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // è¼”åŠ©å‡½æ•¸
        function getFieldName(field) {
            const names = {
                'year': 'å‡ºç”Ÿå¹´',
                'month': 'å‡ºç”Ÿæœˆ',
                'day': 'å‡ºç”Ÿæ—¥',
                'hour': 'å‡ºç”Ÿæ™‚'
            };
            return names[field] || field;
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>

